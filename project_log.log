2026-01-08 19:03:04,170 - INFO - === Starting Stroke Prediction Pipeline ===
2026-01-08 19:03:04,171 - INFO - Attempting to load dataset from stroke_df\healthcare-dataset-stroke-data.csv
2026-01-08 19:03:04,186 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-08 19:03:04,186 - INFO - START: processing column 'bmi'.
2026-01-08 19:03:04,188 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-08 19:03:04,188 - INFO - Starting conversion of continuous variables to categorical categories...
2026-01-08 19:03:04,252 - INFO - Successfully created 'risk_group' column.
2026-01-08 19:03:04,259 - INFO - Composite Variable Created Successfully. Group Distribution:
risk_group
neither         2797
bmi_only        1492
both_high        428
glucose_only     393
Name: count, dtype: int64
2026-01-08 19:03:04,259 - INFO - Pipeline finished successfully.
2026-01-08 19:19:07,456 - INFO - === Starting Stroke Prediction Pipeline ===
2026-01-08 19:19:07,457 - INFO - Attempting to load dataset from stroke_df\healthcare-dataset-stroke-data.csv
2026-01-08 19:19:07,497 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-08 19:19:07,498 - INFO - START: processing column 'bmi'.
2026-01-08 19:19:07,507 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-08 19:19:07,509 - INFO - Starting conversion of continuous variables to categorical categories...
2026-01-08 19:19:07,596 - INFO - Successfully created 'risk_group' column.
2026-01-08 19:19:07,619 - INFO - Composite Variable Created Successfully. Group Distribution:
risk_group
neither         2797
bmi_only        1492
both_high        428
glucose_only     393
Name: count, dtype: int64
2026-01-08 19:19:07,621 - INFO - Pipeline finished successfully.
2026-01-08 19:19:12,559 - INFO - === Starting Stroke Prediction Pipeline ===
2026-01-08 19:19:12,561 - INFO - Attempting to load dataset from stroke_df\healthcare-dataset-stroke-data.csv
2026-01-08 19:19:12,652 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-08 19:19:12,658 - INFO - START: processing column 'bmi'.
2026-01-08 19:19:12,668 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-08 19:19:12,687 - INFO - Starting conversion of continuous variables to categorical categories...
2026-01-08 19:19:12,830 - INFO - Successfully created 'risk_group' column.
2026-01-08 19:19:12,846 - INFO - Composite Variable Created Successfully. Group Distribution:
risk_group
neither         2797
bmi_only        1492
both_high        428
glucose_only     393
Name: count, dtype: int64
2026-01-08 19:19:12,847 - INFO - Pipeline finished successfully.
2026-01-08 19:19:17,530 - INFO - === Starting Stroke Prediction Pipeline ===
2026-01-08 19:19:17,538 - INFO - Attempting to load dataset from stroke_df\healthcare-dataset-stroke-data.csv
2026-01-08 19:19:17,591 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-08 19:19:17,594 - INFO - START: processing column 'bmi'.
2026-01-08 19:19:17,598 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-08 19:19:17,605 - INFO - Starting conversion of continuous variables to categorical categories...
2026-01-08 19:19:17,723 - INFO - Successfully created 'risk_group' column.
2026-01-08 19:19:17,738 - INFO - Composite Variable Created Successfully. Group Distribution:
risk_group
neither         2797
bmi_only        1492
both_high        428
glucose_only     393
Name: count, dtype: int64
2026-01-08 19:19:17,739 - INFO - Pipeline finished successfully.
2026-01-10 15:13:47,452 - INFO - ==========================================
2026-01-10 15:13:47,454 - INFO -    STARTING STROKE ANALYSIS PIPELINE      
2026-01-10 15:13:47,454 - INFO - ==========================================
2026-01-10 15:13:47,454 - INFO - Step 1: Loading dataset from stroke_df/healthcare-dataset-stroke-data.csv...
2026-01-10 15:13:47,455 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-10 15:13:47,502 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-10 15:13:47,502 - INFO - Step 2: Cleaning and Preprocessing Data...
2026-01-10 15:13:47,502 - ERROR - Error in convert_to_numeric: safe_convert_to_numeric() missing 1 required positional argument: 'col_name'
2026-01-10 15:13:47,503 - ERROR - Error in fill_missing_values: fill_missing_with_median() missing 1 required positional argument: 'col_name'
2026-01-10 15:13:47,504 - ERROR - Error in create_risk_groups: Missing required column: 'bmi_high'. Run 'convert_continuous_to_categorical' first.
2026-01-10 15:13:47,505 - INFO - Step 3: Running Statistical Analysis...
2026-01-10 15:13:47,505 - INFO - --> Running Chi-Square Test (General Association)...
2026-01-10 15:13:47,505 - INFO - Starting Chi-Square test between 'risk_group' and 'stroke'.
2026-01-10 15:13:47,506 - ERROR - Column selection error: "Columns 'risk_group' or 'stroke' not found in DataFrame."
2026-01-10 15:13:47,507 - INFO - --> Running Relative Risk Analysis (Specific Group Comparisons)...
2026-01-10 15:13:47,507 - INFO - Running full analysis pipeline...
2026-01-10 15:13:47,507 - ERROR - Error in Relative Risk Analysis: 'risk_group'
2026-01-10 15:13:47,508 - INFO - ==========================================
2026-01-10 15:13:47,508 - INFO -    ANALYSIS COMPLETE. CHECK LOGS.         
2026-01-10 15:13:47,508 - INFO - ==========================================
2026-01-10 15:15:33,628 - INFO - ==========================================
2026-01-10 15:15:33,630 - INFO -    STARTING STROKE ANALYSIS PIPELINE      
2026-01-10 15:15:33,630 - INFO - ==========================================
2026-01-10 15:15:33,631 - INFO - Step 1: Loading dataset from stroke_df/healthcare-dataset-stroke-data.csv...
2026-01-10 15:15:33,631 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-10 15:15:33,669 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-10 15:15:33,670 - INFO - Step 2: Cleaning and Preprocessing Data...
2026-01-10 15:15:33,670 - ERROR - Error in convert_to_numeric: safe_convert_to_numeric() missing 1 required positional argument: 'col_name'
2026-01-10 15:15:33,671 - ERROR - Error in fill_missing_values: fill_missing_with_median() missing 1 required positional argument: 'col_name'
2026-01-10 15:15:33,671 - ERROR - Error in create_risk_groups: Missing required column: 'bmi_high'. Run 'convert_continuous_to_categorical' first.
2026-01-10 15:15:33,672 - INFO - Step 3: Running Statistical Analysis...
2026-01-10 15:15:33,673 - INFO - --> Running Chi-Square Test (General Association)...
2026-01-10 15:15:33,674 - INFO - Starting Chi-Square test between 'risk_group' and 'stroke'.
2026-01-10 15:15:33,675 - ERROR - Column selection error: "Columns 'risk_group' or 'stroke' not found in DataFrame."
2026-01-10 15:15:33,675 - INFO - --> Running Relative Risk Analysis (Specific Group Comparisons)...
2026-01-10 15:15:33,676 - INFO - Running full analysis pipeline...
2026-01-10 15:15:33,678 - ERROR - Error in Relative Risk Analysis: 'risk_group'
2026-01-10 15:15:33,679 - INFO - ==========================================
2026-01-10 15:15:33,680 - INFO -    ANALYSIS COMPLETE. CHECK LOGS.         
2026-01-10 15:15:33,680 - INFO - ==========================================
2026-01-10 15:16:43,958 - INFO - ==========================================
2026-01-10 15:16:43,960 - INFO -    STARTING STROKE ANALYSIS PIPELINE      
2026-01-10 15:16:43,960 - INFO - ==========================================
2026-01-10 15:16:43,961 - INFO - Step 1: Loading dataset from stroke_df/healthcare-dataset-stroke-data.csv...
2026-01-10 15:16:43,962 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-10 15:16:43,976 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-10 15:16:43,977 - INFO - Step 2: Cleaning and Preprocessing Data...
2026-01-10 15:16:43,977 - ERROR - Error in convert_to_numeric: safe_convert_to_numeric() missing 1 required positional argument: 'col_name'
2026-01-10 15:16:43,978 - ERROR - Error in fill_missing_values: fill_missing_with_median() missing 1 required positional argument: 'col_name'
2026-01-10 15:16:43,980 - ERROR - Error in create_risk_groups: Missing required column: 'bmi_high'. Run 'convert_continuous_to_categorical' first.
2026-01-10 15:16:43,981 - INFO - Step 3: Running Statistical Analysis...
2026-01-10 15:16:43,981 - INFO - --> Running Chi-Square Test (General Association)...
2026-01-10 15:16:43,982 - INFO - Starting Chi-Square test between 'risk_group' and 'stroke'.
2026-01-10 15:16:43,982 - ERROR - Column selection error: "Columns 'risk_group' or 'stroke' not found in DataFrame."
2026-01-10 15:16:43,983 - INFO - --> Running Relative Risk Analysis (Specific Group Comparisons)...
2026-01-10 15:16:43,983 - INFO - Running full analysis pipeline...
2026-01-10 15:16:43,985 - ERROR - Error in Relative Risk Analysis: 'risk_group'
2026-01-10 15:16:43,985 - INFO - ==========================================
2026-01-10 15:16:43,986 - INFO -    ANALYSIS COMPLETE. CHECK LOGS.         
2026-01-10 15:16:43,986 - INFO - ==========================================
2026-01-10 15:27:03,093 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-10 15:27:03,102 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-10 15:27:03,104 - INFO - --- Cleaning Data ---
2026-01-10 15:27:03,105 - INFO - START: processing column 'bmi'.
2026-01-10 15:27:03,107 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-10 15:27:03,109 - INFO - START: processing column 'avg_glucose_level'.
2026-01-10 15:27:03,110 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values were set to NaN.
2026-01-10 15:27:03,110 - INFO -  - Converted columns to numeric.
2026-01-10 15:27:03,111 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-10 15:27:03,115 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-10 15:27:03,116 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-10 15:27:03,117 - INFO -  - Filled missing values in 'bmi'.
2026-01-10 15:27:03,118 - INFO - Starting conversion of continuous variables to categorical categories...
2026-01-10 15:27:03,141 - INFO - Successfully created 'risk_group' column.
2026-01-10 15:27:03,142 - INFO -  - Created categorical columns (bmi_high, glucose_high).
2026-01-10 15:27:03,150 - INFO - Composite Variable Created Successfully. Group Distribution:
risk_group
neither         2797
bmi_only        1492
both_high        428
glucose_only     393
Name: count, dtype: int64
2026-01-10 15:27:03,151 - INFO -  - Created 'risk_group' variable.
2026-01-10 15:27:03,151 - INFO - --- Running Analysis ---
2026-01-10 15:27:03,152 - INFO - Running Chi-Square...
2026-01-10 15:27:03,158 - INFO - Starting Chi-Square test between 'risk_group' and 'stroke'.
2026-01-10 15:27:03,252 - INFO - Contingency table created. Shape: (4, 2)
2026-01-10 15:27:03,254 - INFO - Test Complete. P-value: 0.00000 -> Result: Significant (Reject H0)
2026-01-10 15:27:03,255 - INFO - Running Relative Risk...
2026-01-10 15:27:03,256 - INFO - Running full analysis pipeline...
2026-01-10 15:27:03,256 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-10 15:27:03,263 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-10 15:27:03,266 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-10 15:27:03,269 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-10 15:27:03,270 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-10 15:27:03,275 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-10 15:27:03,278 - INFO - ==================================================
2026-01-10 15:27:03,278 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-10 15:27:03,279 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-10 15:27:03,280 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-10 15:27:03,283 - INFO - ==================================================
2026-01-13 21:06:55,792 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-13 21:06:55,794 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-13 21:06:55,867 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-13 21:06:55,868 - INFO - --- Phase 1: Data Cleaning ---
2026-01-13 21:06:55,868 - INFO - START: Attempting to remove columns: ['id']
2026-01-13 21:06:55,891 - INFO - Successfully dropped columns: ['id']
2026-01-13 21:06:55,893 - INFO - START: processing column 'bmi'.
2026-01-13 21:06:55,895 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-13 21:06:55,897 - INFO - START: processing column 'avg_glucose_level'.
2026-01-13 21:06:55,905 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values were set to NaN.
2026-01-13 21:06:55,906 - INFO - START: processing column 'age'.
2026-01-13 21:06:55,912 - INFO - SUCCESS: Column 'age' converted. 0 invalid values were set to NaN.
2026-01-13 21:06:55,913 - WARNING - fill_missing_values not found. Skipping (Clustering might fail).
2026-01-13 21:06:55,913 - INFO - --- Phase 2: Outlier Detection ---
2026-01-13 21:06:55,913 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-13 21:06:55,922 - INFO - IQR Bounds calculated for 'bmi': [4.30, 52.30]
2026-01-13 21:06:55,923 - INFO - Stats: Removing 259 outliers (5.07% of data).
2026-01-13 21:06:55,927 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-13 21:06:55,929 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.61, 167.83]
2026-01-13 21:06:55,930 - INFO - Stats: Removing 553 outliers (11.40% of data).
2026-01-13 21:06:55,931 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-13 21:06:55,935 - INFO - --- Phase 3: Feature Engineering ---
2026-01-13 21:06:55,935 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-13 21:06:56,021 - INFO - Successfully created 'risk_group' column.
2026-01-13 21:06:56,037 - INFO - Composite Variable Created. Group Distribution: {'neither': 2662, 'bmi_only': 1451, 'glucose_only': 115, 'both_high': 70}
2026-01-13 21:06:56,037 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-13 21:06:56,037 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-13 21:06:56,068 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-13 21:06:56,068 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-13 21:06:56,068 - INFO - Test Finished. P-value: 0.90770 | Result: Not Significant (Fail to Reject H0)
2026-01-13 21:06:56,068 - INFO - Running full analysis pipeline...
2026-01-13 21:06:56,068 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-13 21:06:56,083 - INFO - Analysis Done. RR=1.4085, p=0.5521
2026-01-13 21:06:56,083 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-13 21:06:56,101 - INFO - Analysis Done. RR=1.0872, p=0.6410
2026-01-13 21:06:56,103 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-13 21:06:56,117 - INFO - Analysis Done. RR=1.1431, p=0.7907
2026-01-13 21:06:56,123 - INFO - ==================================================
2026-01-13 21:06:56,123 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-13 21:06:56,125 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-13 21:06:56,125 - INFO - Risk Factor (RR): 1.4085 (CI: 0.456-4.35)
2026-01-13 21:06:56,125 - INFO - ==================================================
2026-01-13 21:06:56,145 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-13 21:06:56,145 - INFO - Starting K-Means pipeline with 3 clusters...
2026-01-13 21:06:59,672 - INFO - Clustering pipeline complete.
2026-01-13 21:06:59,673 - INFO - Generating PCA plot...
2026-01-13 21:07:11,654 - INFO - Generating Risk Bar Chart...
2026-01-13 21:07:14,600 - INFO - Pipeline Finished Successfully. 
2026-01-13 21:14:26,736 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-13 21:14:26,736 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-13 21:14:26,768 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-13 21:14:26,768 - INFO - --- Phase 1: Data Cleaning ---
2026-01-13 21:14:26,770 - INFO - START: Attempting to remove columns: ['id']
2026-01-13 21:14:26,788 - INFO - Successfully dropped columns: ['id']
2026-01-13 21:14:26,790 - INFO - START: processing column 'bmi'.
2026-01-13 21:14:26,790 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values were set to NaN.
2026-01-13 21:14:26,792 - INFO - START: processing column 'avg_glucose_level'.
2026-01-13 21:14:26,796 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values were set to NaN.
2026-01-13 21:14:26,797 - INFO - START: processing column 'age'.
2026-01-13 21:14:26,799 - INFO - SUCCESS: Column 'age' converted. 0 invalid values were set to NaN.
2026-01-13 21:14:26,799 - WARNING - fill_missing_values not found. Skipping (Clustering might fail).
2026-01-13 21:14:26,800 - INFO - --- Phase 2: Outlier Detection ---
2026-01-13 21:14:26,800 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-13 21:14:26,808 - INFO - IQR Bounds calculated for 'bmi': [4.30, 52.30]
2026-01-13 21:14:26,809 - INFO - Stats: Removing 259 outliers (5.07% of data).
2026-01-13 21:14:26,815 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-13 21:14:26,817 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.61, 167.83]
2026-01-13 21:14:26,818 - INFO - Stats: Removing 553 outliers (11.40% of data).
2026-01-13 21:14:26,819 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-13 21:14:26,822 - INFO - --- Phase 3: Feature Engineering ---
2026-01-13 21:14:26,823 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-13 21:14:26,851 - INFO - Successfully created 'risk_group' column.
2026-01-13 21:14:26,859 - INFO - Composite Variable Created. Group Distribution: {'neither': 2662, 'bmi_only': 1451, 'glucose_only': 115, 'both_high': 70}
2026-01-13 21:14:26,859 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-13 21:14:26,860 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-13 21:14:26,880 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-13 21:14:26,884 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-13 21:14:26,884 - INFO - Test Finished. P-value: 0.90770 | Result: Not Significant (Fail to Reject H0)
2026-01-13 21:14:26,884 - INFO - Running full analysis pipeline...
2026-01-13 21:14:26,885 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-13 21:14:26,888 - INFO - Analysis Done. RR=1.4085, p=0.5521
2026-01-13 21:14:26,888 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-13 21:14:26,894 - INFO - Analysis Done. RR=1.0872, p=0.6410
2026-01-13 21:14:26,895 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-13 21:14:26,902 - INFO - Analysis Done. RR=1.1431, p=0.7907
2026-01-13 21:14:26,904 - INFO - ==================================================
2026-01-13 21:14:26,904 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-13 21:14:26,904 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-13 21:14:26,904 - INFO - Risk Factor (RR): 1.4085 (CI: 0.456-4.35)
2026-01-13 21:14:26,904 - INFO - ==================================================
2026-01-13 21:14:26,924 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-13 21:14:26,924 - INFO - Starting K-Means pipeline with 3 clusters...
2026-01-13 21:14:29,185 - INFO - Clustering pipeline complete.
2026-01-13 21:14:29,185 - INFO - Generating PCA plot...
2026-01-13 21:14:31,986 - INFO - Generating Risk Bar Chart...
2026-01-13 21:14:33,404 - INFO - Pipeline Finished Successfully. 
2026-01-14 18:00:32,522 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:00:32,523 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:00:32,581 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:00:32,582 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:00:32,582 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:00:32,602 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:00:32,604 - INFO - START: processing column 'bmi'.
2026-01-14 18:00:32,606 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:00:32,606 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:00:32,607 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:00:32,608 - INFO - START: processing column 'age'.
2026-01-14 18:00:32,611 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:02:28,682 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:02:28,683 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:02:28,695 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:02:28,696 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:02:28,696 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:02:28,699 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:02:28,700 - INFO - START: processing column 'bmi'.
2026-01-14 18:02:28,702 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:02:28,702 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:02:28,705 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:02:28,705 - INFO - START: processing column 'age'.
2026-01-14 18:02:28,707 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:02:28,709 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:02:28,716 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:02:28,718 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:02:28,719 - INFO - --- Phase 2: Outlier Detection ---
2026-01-14 18:02:28,720 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-14 18:02:28,726 - INFO - IQR Bounds calculated for 'bmi': [5.80, 50.80]
2026-01-14 18:02:28,727 - INFO - Stats: Removing 67 outliers (1.31% of data).
2026-01-14 18:02:28,730 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:02:28,733 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.24, 168.98]
2026-01-14 18:02:28,735 - INFO - Stats: Removing 608 outliers (12.06% of data).
2026-01-14 18:02:28,761 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:02:28,768 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:02:28,770 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:02:28,851 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:02:28,864 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1444, 'glucose_only': 123, 'both_high': 71}
2026-01-14 18:02:28,865 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:02:28,866 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:02:28,889 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:02:28,893 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-14 18:02:28,894 - INFO - Test Finished. P-value: 0.72941 | Result: Not Significant (Fail to Reject H0)
2026-01-14 18:02:28,894 - INFO - Running full analysis pipeline...
2026-01-14 18:02:28,895 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:02:28,904 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 18:02:28,904 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:02:28,911 - INFO - Analysis Done. RR=0.8609, p=0.3785
2026-01-14 18:02:28,912 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:02:28,917 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 18:02:28,920 - INFO - ==================================================
2026-01-14 18:02:28,920 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:02:28,921 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 18:02:28,922 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 18:02:28,922 - INFO - ==================================================
2026-01-14 18:02:28,947 - INFO - Generating visualizations...
2026-01-14 18:02:28,948 - INFO - Running full analysis pipeline...
2026-01-14 18:02:28,949 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:02:28,955 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 18:02:28,956 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:02:28,961 - INFO - Analysis Done. RR=0.8609, p=0.3785
2026-01-14 18:02:28,962 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:02:28,967 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 18:02:28,972 - INFO - ==================================================
2026-01-14 18:02:28,973 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:02:28,974 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 18:02:28,975 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 18:02:28,976 - INFO - ==================================================
2026-01-14 18:02:28,977 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:02:28,978 - INFO - Generating Stacked Bar Chart
2026-01-14 18:02:32,063 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:02:32,065 - INFO - Generating Mosaic Plot...
2026-01-14 18:02:32,837 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:02:32,838 - INFO - Generating Residuals Heatmap...
2026-01-14 18:02:33,344 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:02:33,344 - INFO - Generating Forest Plot...
2026-01-14 18:02:33,765 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:02:33,765 - INFO - Generating Lollipop Plot...
2026-01-14 18:02:34,104 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:02:34,104 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:02:34,104 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:02:34,105 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:02:34,105 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:02:34,107 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:02:34,107 - INFO - START: Searching for optimal K (range: 2 to 10).
2026-01-14 18:02:34,108 - INFO - Preparing data for optimization analysis...
2026-01-14 18:02:34,123 - INFO - Calculating metrics for each K...
2026-01-14 18:02:40,659 - INFO - Generating Elbow plot...
2026-01-14 18:12:58,167 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:12:58,168 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:12:58,179 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:13:43,460 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:13:43,461 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:13:43,469 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:13:43,470 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:13:43,470 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:13:43,472 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:13:43,472 - INFO - START: processing column 'bmi'.
2026-01-14 18:13:43,474 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:13:43,474 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:13:43,475 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:13:43,476 - INFO - START: processing column 'age'.
2026-01-14 18:13:43,477 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:13:43,477 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:13:43,479 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:13:43,480 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:13:59,073 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:13:59,074 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:13:59,083 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:13:59,084 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:13:59,084 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:13:59,087 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:13:59,087 - INFO - START: processing column 'bmi'.
2026-01-14 18:13:59,088 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:13:59,089 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:13:59,090 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:13:59,090 - INFO - START: processing column 'age'.
2026-01-14 18:13:59,091 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:13:59,092 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:13:59,093 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:13:59,094 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:13:59,094 - INFO - --- Phase 2: Outlier Detection ---
2026-01-14 18:13:59,094 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-14 18:13:59,096 - INFO - IQR Bounds calculated for 'bmi': [5.80, 50.80]
2026-01-14 18:13:59,097 - INFO - Stats: Removing 67 outliers (1.31% of data).
2026-01-14 18:13:59,098 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:13:59,100 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.24, 168.98]
2026-01-14 18:13:59,100 - INFO - Stats: Removing 608 outliers (12.06% of data).
2026-01-14 18:13:59,101 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:14:12,330 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:14:12,331 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:14:12,341 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:14:12,342 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:14:12,342 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:14:12,343 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:14:12,344 - INFO - START: processing column 'bmi'.
2026-01-14 18:14:12,345 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:14:12,345 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:14:12,346 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:14:12,346 - INFO - START: processing column 'age'.
2026-01-14 18:14:12,347 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:14:12,348 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:14:12,349 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:14:12,350 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:14:12,350 - INFO - --- Phase 2: Outlier Detection ---
2026-01-14 18:14:12,351 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-14 18:14:12,352 - INFO - IQR Bounds calculated for 'bmi': [5.80, 50.80]
2026-01-14 18:14:12,353 - INFO - Stats: Removing 67 outliers (1.31% of data).
2026-01-14 18:14:12,356 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:14:12,359 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.24, 168.98]
2026-01-14 18:14:12,359 - INFO - Stats: Removing 608 outliers (12.06% of data).
2026-01-14 18:14:12,360 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:14:12,361 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:14:12,362 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:14:12,395 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:14:12,400 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1444, 'glucose_only': 123, 'both_high': 71}
2026-01-14 18:14:28,690 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:14:28,690 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:14:28,701 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:14:28,702 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:14:28,702 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:14:28,704 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:14:28,704 - INFO - START: processing column 'bmi'.
2026-01-14 18:14:28,706 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:14:28,706 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:14:28,707 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:14:28,708 - INFO - START: processing column 'age'.
2026-01-14 18:14:28,709 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:14:28,709 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:14:28,711 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:14:28,712 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:14:28,712 - INFO - --- Phase 2: Outlier Detection ---
2026-01-14 18:14:28,712 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-14 18:14:28,714 - INFO - IQR Bounds calculated for 'bmi': [5.80, 50.80]
2026-01-14 18:14:28,715 - INFO - Stats: Removing 67 outliers (1.31% of data).
2026-01-14 18:14:28,717 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:14:28,719 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.24, 168.98]
2026-01-14 18:14:28,719 - INFO - Stats: Removing 608 outliers (12.06% of data).
2026-01-14 18:14:28,720 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:14:28,721 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:14:28,721 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:14:28,759 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:14:28,764 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1444, 'glucose_only': 123, 'both_high': 71}
2026-01-14 18:14:28,764 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:14:28,765 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:14:28,775 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:14:28,776 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-14 18:14:28,777 - INFO - Test Finished. P-value: 0.72941 | Result: Not Significant (Fail to Reject H0)
2026-01-14 18:14:28,777 - INFO - Running full analysis pipeline...
2026-01-14 18:14:28,778 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:14:28,783 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 18:14:28,783 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:14:28,789 - INFO - Analysis Done. RR=0.8609, p=0.3785
2026-01-14 18:14:28,790 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:14:28,794 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 18:14:28,796 - INFO - ==================================================
2026-01-14 18:14:28,796 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:14:28,796 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 18:14:28,797 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 18:14:28,797 - INFO - ==================================================
2026-01-14 18:15:28,079 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:15:28,079 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:15:28,088 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:15:28,089 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:15:28,089 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:15:28,090 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:15:28,091 - INFO - START: processing column 'bmi'.
2026-01-14 18:15:28,092 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:15:28,092 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:15:28,093 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:15:28,093 - INFO - START: processing column 'age'.
2026-01-14 18:15:28,094 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:15:28,094 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:15:28,096 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:15:28,097 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:15:28,098 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:15:28,099 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:15:28,139 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:15:28,144 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:15:28,144 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:15:28,144 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:15:28,155 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:15:28,156 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:15:28,157 - INFO - Running full analysis pipeline...
2026-01-14 18:15:28,157 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:15:28,163 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:15:28,164 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:15:28,170 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:15:28,170 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:15:28,176 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:15:28,177 - INFO - ==================================================
2026-01-14 18:15:28,178 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:15:28,178 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:15:28,178 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:15:28,179 - INFO - ==================================================
2026-01-14 18:15:28,187 - INFO - Generating visualizations...
2026-01-14 18:15:28,187 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:15:28,188 - INFO - Generating Stacked Bar Chart
2026-01-14 18:15:28,697 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:15:28,697 - INFO - Generating Mosaic Plot...
2026-01-14 18:15:29,149 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:15:29,149 - INFO - Generating Residuals Heatmap...
2026-01-14 18:15:29,462 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:15:29,462 - INFO - Generating Forest Plot...
2026-01-14 18:15:29,812 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:15:29,813 - INFO - Generating Lollipop Plot...
2026-01-14 18:15:30,082 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:15:30,083 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:15:30,083 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:15:30,083 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:15:30,084 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:15:30,086 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:15:30,086 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:15:30,086 - INFO - Preparing data for optimization analysis...
2026-01-14 18:15:30,099 - INFO - Calculating metrics for each K...
2026-01-14 18:15:30,100 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:15:30,100 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:15:31,625 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:15:31,626 - INFO - START: Generating PCA Visualization.
2026-01-14 18:15:31,825 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:20:51,190 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:20:51,190 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:20:51,200 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:20:51,200 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:20:51,200 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:20:51,202 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:20:51,202 - INFO - START: processing column 'bmi'.
2026-01-14 18:20:51,203 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:20:51,203 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:20:51,204 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:20:51,205 - INFO - START: processing column 'age'.
2026-01-14 18:20:51,205 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:20:51,206 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:20:51,207 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:20:51,208 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:20:51,208 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-14 18:20:51,209 - INFO - IQR Bounds calculated for 'bmi': [5.80, 50.80]
2026-01-14 18:20:51,210 - INFO - Stats: Removing 67 outliers (1.31% of data).
2026-01-14 18:20:51,212 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:20:51,212 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:20:51,250 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:20:51,256 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1444, 'both_high': 409, 'glucose_only': 393}
2026-01-14 18:20:51,257 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:20:51,257 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:20:51,266 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:20:51,267 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:20:51,268 - INFO - Running full analysis pipeline...
2026-01-14 18:20:51,268 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:20:51,273 - INFO - Analysis Done. RR=3.1027, p=0.0000
2026-01-14 18:20:51,273 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:20:51,279 - INFO - Analysis Done. RR=0.8609, p=0.3785
2026-01-14 18:20:51,280 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:20:51,284 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:20:51,286 - INFO - ==================================================
2026-01-14 18:20:51,287 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:20:51,287 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:20:51,287 - INFO - Risk Factor (RR): 3.1027 (CI: 2.2502-4.2782)
2026-01-14 18:20:51,287 - INFO - ==================================================
2026-01-14 18:20:51,299 - INFO - Generating visualizations...
2026-01-14 18:20:51,299 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:20:51,300 - INFO - Generating Stacked Bar Chart
2026-01-14 18:20:51,809 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:20:51,809 - INFO - Generating Mosaic Plot...
2026-01-14 18:20:52,222 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:20:52,222 - INFO - Generating Residuals Heatmap...
2026-01-14 18:20:52,549 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:20:52,550 - INFO - Generating Forest Plot...
2026-01-14 18:20:52,832 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:20:52,833 - INFO - Generating Lollipop Plot...
2026-01-14 18:20:53,131 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:20:53,131 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:20:53,132 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:20:53,132 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:20:53,132 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:20:53,136 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:20:53,136 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:20:53,137 - INFO - Preparing data for optimization analysis...
2026-01-14 18:20:53,152 - INFO - Calculating metrics for each K...
2026-01-14 18:20:53,153 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:20:53,153 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:20:54,688 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:20:54,689 - INFO - START: Generating PCA Visualization.
2026-01-14 18:20:54,879 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:22:01,814 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:22:01,814 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:22:01,823 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:22:01,823 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:22:01,824 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:22:01,825 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:22:01,825 - INFO - START: processing column 'bmi'.
2026-01-14 18:22:01,827 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:22:01,827 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:22:01,828 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:22:01,829 - INFO - START: processing column 'age'.
2026-01-14 18:22:01,830 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:22:01,830 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:22:01,831 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:22:01,831 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:22:01,832 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:22:01,834 - INFO - IQR Bounds calculated for 'avg_glucose_level': [21.98, 169.36]
2026-01-14 18:22:01,835 - INFO - Stats: Removing 627 outliers (12.27% of data).
2026-01-14 18:22:01,835 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:22:01,837 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:22:01,838 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:22:01,874 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:22:01,879 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'glucose_only': 123, 'both_high': 71}
2026-01-14 18:22:01,880 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:22:01,880 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:22:01,890 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:22:01,891 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-14 18:22:01,892 - INFO - Test Finished. P-value: 0.63285 | Result: Not Significant (Fail to Reject H0)
2026-01-14 18:22:01,892 - INFO - Running full analysis pipeline...
2026-01-14 18:22:01,892 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:22:01,896 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 18:22:01,897 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:22:01,903 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:22:01,903 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:22:01,909 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 18:22:01,911 - INFO - ==================================================
2026-01-14 18:22:01,911 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:22:01,912 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 18:22:01,912 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 18:22:01,912 - INFO - ==================================================
2026-01-14 18:22:01,921 - INFO - Generating visualizations...
2026-01-14 18:22:01,922 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:22:01,922 - INFO - Generating Stacked Bar Chart
2026-01-14 18:22:02,432 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:22:02,433 - INFO - Generating Mosaic Plot...
2026-01-14 18:22:02,963 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:22:02,964 - INFO - Generating Residuals Heatmap...
2026-01-14 18:22:03,356 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:22:03,357 - INFO - Generating Forest Plot...
2026-01-14 18:22:03,659 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:22:03,659 - INFO - Generating Lollipop Plot...
2026-01-14 18:22:03,912 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:22:03,956 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:22:03,957 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:22:03,957 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:22:03,957 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:22:03,959 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:22:03,959 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:22:03,960 - INFO - Preparing data for optimization analysis...
2026-01-14 18:22:03,974 - INFO - Calculating metrics for each K...
2026-01-14 18:22:03,975 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:22:03,975 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:22:05,564 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:22:05,564 - INFO - START: Generating PCA Visualization.
2026-01-14 18:22:05,743 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:22:54,869 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:22:54,870 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:22:54,879 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:22:54,879 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:22:54,879 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:22:54,881 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:22:54,882 - INFO - START: processing column 'bmi'.
2026-01-14 18:22:54,883 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:22:54,884 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:22:54,886 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:22:54,887 - INFO - START: processing column 'age'.
2026-01-14 18:22:54,889 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:22:54,889 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:22:54,891 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:22:54,891 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:22:54,891 - INFO - Starting outlier removal for 'bmi' (Threshold: 1.5)
2026-01-14 18:22:54,892 - INFO - IQR Bounds calculated for 'bmi': [10.30, 46.30]
2026-01-14 18:22:54,893 - INFO - Stats: Removing 126 outliers (2.47% of data).
2026-01-14 18:22:54,895 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:22:54,895 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:22:54,932 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:22:54,940 - INFO - Composite Variable Created. Group Distribution: {'neither': 2796, 'bmi_only': 1404, 'glucose_only': 393, 'both_high': 391}
2026-01-14 18:22:54,941 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:22:54,941 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:22:54,954 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:22:54,956 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:22:54,956 - INFO - Running full analysis pipeline...
2026-01-14 18:22:54,957 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:22:54,967 - INFO - Analysis Done. RR=3.112, p=0.0000
2026-01-14 18:22:54,967 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:22:54,978 - INFO - Analysis Done. RR=0.8851, p=0.4730
2026-01-14 18:22:54,979 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:22:54,986 - INFO - Analysis Done. RR=2.8326, p=0.0000
2026-01-14 18:22:54,989 - INFO - ==================================================
2026-01-14 18:22:54,989 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:22:54,990 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:22:54,990 - INFO - Risk Factor (RR): 3.112 (CI: 2.2468-4.3102)
2026-01-14 18:22:54,991 - INFO - ==================================================
2026-01-14 18:22:55,003 - INFO - Generating visualizations...
2026-01-14 18:22:55,003 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:22:55,003 - INFO - Generating Stacked Bar Chart
2026-01-14 18:22:55,598 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:22:55,598 - INFO - Generating Mosaic Plot...
2026-01-14 18:22:56,083 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:22:56,084 - INFO - Generating Residuals Heatmap...
2026-01-14 18:22:56,439 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:22:56,440 - INFO - Generating Forest Plot...
2026-01-14 18:22:56,755 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:22:56,755 - INFO - Generating Lollipop Plot...
2026-01-14 18:22:57,017 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:22:57,017 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:22:57,017 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:22:57,017 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:22:57,018 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:22:57,019 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:22:57,020 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:22:57,020 - INFO - Preparing data for optimization analysis...
2026-01-14 18:22:57,031 - INFO - Calculating metrics for each K...
2026-01-14 18:22:57,032 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:22:57,032 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:22:58,596 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:22:58,596 - INFO - START: Generating PCA Visualization.
2026-01-14 18:22:58,811 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:23:42,753 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:23:42,754 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:23:42,763 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:23:42,764 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:23:42,764 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:23:42,766 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:23:42,766 - INFO - START: processing column 'bmi'.
2026-01-14 18:23:42,767 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:23:42,768 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:23:42,769 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:23:42,769 - INFO - START: processing column 'age'.
2026-01-14 18:23:42,771 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:23:42,771 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:23:42,772 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:23:42,773 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:23:42,773 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:23:42,773 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:23:42,809 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:23:42,814 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:23:42,815 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:23:42,815 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:23:42,824 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:23:42,827 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:23:42,827 - INFO - Running full analysis pipeline...
2026-01-14 18:23:42,827 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:23:42,834 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:23:42,835 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:23:42,841 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:23:42,842 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:23:42,846 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:23:42,848 - INFO - ==================================================
2026-01-14 18:23:42,848 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:23:42,848 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:23:42,849 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:23:42,849 - INFO - ==================================================
2026-01-14 18:23:42,858 - INFO - Generating visualizations...
2026-01-14 18:23:42,858 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:23:42,858 - INFO - Generating Stacked Bar Chart
2026-01-14 18:23:43,376 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:23:43,377 - INFO - Generating Mosaic Plot...
2026-01-14 18:23:43,766 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:23:43,766 - INFO - Generating Residuals Heatmap...
2026-01-14 18:23:44,102 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:23:44,102 - INFO - Generating Forest Plot...
2026-01-14 18:23:44,385 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:23:44,386 - INFO - Generating Lollipop Plot...
2026-01-14 18:23:44,633 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:23:44,633 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:23:44,633 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:23:44,633 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:23:44,633 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:23:44,635 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:23:44,635 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:23:44,636 - INFO - Preparing data for optimization analysis...
2026-01-14 18:23:44,648 - INFO - Calculating metrics for each K...
2026-01-14 18:23:44,649 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:23:44,649 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:23:46,175 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:23:46,176 - INFO - START: Generating PCA Visualization.
2026-01-14 18:23:46,386 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:23:49,215 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:23:49,216 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:23:49,239 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:23:49,239 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:23:49,258 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:23:49,261 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:23:49,488 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:23:53,320 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:23:53,572 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:24:48,187 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:24:48,187 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:24:48,199 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:24:48,199 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:24:48,199 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:24:48,202 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:24:48,203 - INFO - START: processing column 'bmi'.
2026-01-14 18:24:48,204 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:24:48,205 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:24:48,206 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:24:48,206 - INFO - START: processing column 'age'.
2026-01-14 18:24:48,207 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:24:48,207 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:24:48,208 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:24:48,209 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:24:48,209 - INFO - Starting outlier removal for 'bmi' (Threshold: 1.5)
2026-01-14 18:24:48,211 - INFO - IQR Bounds calculated for 'bmi': [10.30, 46.30]
2026-01-14 18:24:48,212 - INFO - Stats: Removing 126 outliers (2.47% of data).
2026-01-14 18:24:48,214 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:24:48,214 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:24:48,254 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:24:48,259 - INFO - Composite Variable Created. Group Distribution: {'neither': 2796, 'bmi_only': 1404, 'glucose_only': 393, 'both_high': 391}
2026-01-14 18:24:48,259 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:24:48,260 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:24:48,274 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:24:48,275 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:24:48,276 - INFO - Running full analysis pipeline...
2026-01-14 18:24:48,276 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:24:48,283 - INFO - Analysis Done. RR=3.112, p=0.0000
2026-01-14 18:24:48,283 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:24:48,289 - INFO - Analysis Done. RR=0.8851, p=0.4730
2026-01-14 18:24:48,289 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:24:48,295 - INFO - Analysis Done. RR=2.8326, p=0.0000
2026-01-14 18:24:48,297 - INFO - ==================================================
2026-01-14 18:24:48,297 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:24:48,298 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:24:48,298 - INFO - Risk Factor (RR): 3.112 (CI: 2.2468-4.3102)
2026-01-14 18:24:48,298 - INFO - ==================================================
2026-01-14 18:24:48,306 - INFO - Generating visualizations...
2026-01-14 18:24:48,307 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:24:48,307 - INFO - Generating Stacked Bar Chart
2026-01-14 18:24:48,783 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:24:48,784 - INFO - Generating Mosaic Plot...
2026-01-14 18:24:49,217 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:24:49,218 - INFO - Generating Residuals Heatmap...
2026-01-14 18:24:49,714 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:24:49,714 - INFO - Generating Forest Plot...
2026-01-14 18:24:50,028 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:24:50,028 - INFO - Generating Lollipop Plot...
2026-01-14 18:24:50,267 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:24:50,267 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:24:50,267 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:24:50,268 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:24:50,268 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:24:50,269 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:24:50,270 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:24:50,270 - INFO - Preparing data for optimization analysis...
2026-01-14 18:24:50,282 - INFO - Calculating metrics for each K...
2026-01-14 18:24:50,283 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:24:50,283 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:24:51,819 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:24:51,819 - INFO - START: Generating PCA Visualization.
2026-01-14 18:24:52,028 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:24:55,063 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:24:55,064 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:24:55,069 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        36.97              89.27  24.08          0.05           0.04    0.04   2841
1        51.48             127.55  33.78          0.15           0.08    0.06   2143
2026-01-14 18:24:55,070 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:24:55,089 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban        Unknown          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:24:55,092 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:24:55,358 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:24:56,772 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:24:57,001 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:24:59,847 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:24:59,847 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:25:44,169 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:25:44,169 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:25:44,183 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:25:44,183 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:25:44,183 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:25:44,185 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:25:44,186 - INFO - START: processing column 'bmi'.
2026-01-14 18:25:44,187 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:25:44,187 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:25:44,188 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:25:44,189 - INFO - START: processing column 'age'.
2026-01-14 18:25:44,191 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:25:44,191 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:25:44,194 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:25:44,196 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:25:44,196 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:25:44,200 - INFO - IQR Bounds calculated for 'avg_glucose_level': [21.98, 169.36]
2026-01-14 18:25:44,202 - INFO - Stats: Removing 627 outliers (12.27% of data).
2026-01-14 18:25:44,202 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:25:44,204 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:25:44,205 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:25:44,247 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:25:44,252 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'glucose_only': 123, 'both_high': 71}
2026-01-14 18:25:44,253 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:25:44,253 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:25:44,269 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:25:44,271 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-14 18:25:44,271 - INFO - Test Finished. P-value: 0.63285 | Result: Not Significant (Fail to Reject H0)
2026-01-14 18:25:44,272 - INFO - Running full analysis pipeline...
2026-01-14 18:25:44,272 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:25:44,278 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 18:25:44,279 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:25:44,288 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:25:44,288 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:25:44,294 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 18:25:44,297 - INFO - ==================================================
2026-01-14 18:25:44,297 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:25:44,298 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 18:25:44,298 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 18:25:44,298 - INFO - ==================================================
2026-01-14 18:25:44,310 - INFO - Generating visualizations...
2026-01-14 18:25:44,311 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:25:44,311 - INFO - Generating Stacked Bar Chart
2026-01-14 18:25:45,405 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:25:45,405 - INFO - Generating Mosaic Plot...
2026-01-14 18:25:45,879 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:25:45,879 - INFO - Generating Residuals Heatmap...
2026-01-14 18:25:46,203 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:25:46,204 - INFO - Generating Forest Plot...
2026-01-14 18:25:46,474 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:25:46,475 - INFO - Generating Lollipop Plot...
2026-01-14 18:25:46,823 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:25:46,824 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:25:46,824 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:25:46,824 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:25:46,824 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:25:46,826 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:25:46,826 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:25:46,827 - INFO - Preparing data for optimization analysis...
2026-01-14 18:25:46,837 - INFO - Calculating metrics for each K...
2026-01-14 18:25:46,838 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:25:46,838 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:25:48,421 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:25:48,422 - INFO - START: Generating PCA Visualization.
2026-01-14 18:25:48,597 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:26:11,328 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:26:11,328 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:26:11,333 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        37.20              89.09  24.03          0.05           0.04    0.04   2817
1        47.13              95.40  35.53          0.11           0.04    0.03   1666
2026-01-14 18:26:11,334 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:26:11,349 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban        Unknown          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:26:11,353 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:26:11,629 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:26:13,399 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:26:13,665 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:26:16,404 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:26:16,404 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:27:00,366 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:27:00,366 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:27:00,377 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:27:00,377 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:27:00,377 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:27:00,379 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:27:00,379 - INFO - START: processing column 'bmi'.
2026-01-14 18:27:00,380 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:27:00,380 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:27:00,381 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:27:00,382 - INFO - START: processing column 'age'.
2026-01-14 18:27:00,382 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:27:00,383 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:27:00,384 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:27:00,384 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:27:00,384 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:27:00,385 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:27:00,422 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:27:00,428 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:27:00,429 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:27:00,429 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:27:00,445 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:27:00,447 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:27:00,448 - INFO - Running full analysis pipeline...
2026-01-14 18:27:00,449 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:27:00,458 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:27:00,459 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:27:00,466 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:27:00,467 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:27:00,473 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:27:00,474 - INFO - ==================================================
2026-01-14 18:27:00,475 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:27:00,475 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:27:00,475 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:27:00,475 - INFO - ==================================================
2026-01-14 18:27:00,485 - INFO - Generating visualizations...
2026-01-14 18:27:00,485 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:27:00,485 - INFO - Generating Stacked Bar Chart
2026-01-14 18:27:01,007 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:27:01,008 - INFO - Generating Mosaic Plot...
2026-01-14 18:27:01,527 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:27:01,527 - INFO - Generating Residuals Heatmap...
2026-01-14 18:27:01,842 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:27:01,842 - INFO - Generating Forest Plot...
2026-01-14 18:27:02,139 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:27:02,139 - INFO - Generating Lollipop Plot...
2026-01-14 18:27:02,399 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:27:02,399 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:27:02,400 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:27:02,400 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:27:02,400 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:27:02,404 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:27:02,404 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:27:02,404 - INFO - Preparing data for optimization analysis...
2026-01-14 18:27:02,418 - INFO - Calculating metrics for each K...
2026-01-14 18:27:02,418 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:27:02,419 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:27:03,977 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:27:03,978 - INFO - START: Generating PCA Visualization.
2026-01-14 18:27:04,183 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:27:06,385 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:27:06,385 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:27:06,390 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:27:06,391 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:27:06,407 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:27:06,410 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:27:06,663 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:27:07,898 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:27:08,152 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:27:09,370 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:27:09,370 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:27:18,245 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:27:18,245 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:27:18,254 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:27:18,255 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:27:18,255 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:27:18,257 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:27:18,257 - INFO - START: processing column 'bmi'.
2026-01-14 18:27:18,258 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:27:18,259 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:27:18,259 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:27:18,260 - INFO - START: processing column 'age'.
2026-01-14 18:27:18,261 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:27:18,261 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:27:18,264 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:27:18,264 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:27:18,264 - INFO - Starting outlier removal for 'bmi' (Threshold: 1.5)
2026-01-14 18:27:18,266 - INFO - IQR Bounds calculated for 'bmi': [10.30, 46.30]
2026-01-14 18:27:18,267 - INFO - Stats: Removing 126 outliers (2.47% of data).
2026-01-14 18:27:18,269 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 18:27:18,272 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.36, 168.59]
2026-01-14 18:27:18,272 - INFO - Stats: Removing 594 outliers (11.92% of data).
2026-01-14 18:27:18,273 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 18:27:18,274 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:27:18,274 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:27:18,310 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:27:18,315 - INFO - Composite Variable Created. Group Distribution: {'neither': 2796, 'bmi_only': 1404, 'glucose_only': 122, 'both_high': 68}
2026-01-14 18:27:18,316 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:27:18,316 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:27:18,325 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:27:18,327 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-14 18:27:18,327 - INFO - Test Finished. P-value: 0.78542 | Result: Not Significant (Fail to Reject H0)
2026-01-14 18:27:18,328 - INFO - Running full analysis pipeline...
2026-01-14 18:27:18,328 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:27:18,334 - INFO - Analysis Done. RR=1.1422, p=0.8167
2026-01-14 18:27:18,334 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:27:18,339 - INFO - Analysis Done. RR=0.8851, p=0.4730
2026-01-14 18:27:18,340 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:27:18,344 - INFO - Analysis Done. RR=1.2732, p=0.5559
2026-01-14 18:27:18,345 - INFO - ==================================================
2026-01-14 18:27:18,346 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:27:18,346 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 18:27:18,346 - INFO - Risk Factor (RR): 1.2732 (CI: 0.571-2.8389)
2026-01-14 18:27:18,346 - INFO - ==================================================
2026-01-14 18:27:18,354 - INFO - Generating visualizations...
2026-01-14 18:27:18,354 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:27:18,354 - INFO - Generating Stacked Bar Chart
2026-01-14 18:27:18,903 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:27:18,903 - INFO - Generating Mosaic Plot...
2026-01-14 18:27:19,345 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:27:19,346 - INFO - Generating Residuals Heatmap...
2026-01-14 18:27:19,675 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:27:19,675 - INFO - Generating Forest Plot...
2026-01-14 18:27:19,987 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:27:19,987 - INFO - Generating Lollipop Plot...
2026-01-14 18:27:20,241 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:27:20,241 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:27:20,241 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:27:20,242 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:27:20,242 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:27:20,243 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:27:20,244 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:27:20,244 - INFO - Preparing data for optimization analysis...
2026-01-14 18:27:20,254 - INFO - Calculating metrics for each K...
2026-01-14 18:27:20,255 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:27:20,255 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:27:21,778 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:27:21,778 - INFO - START: Generating PCA Visualization.
2026-01-14 18:27:21,968 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:27:24,735 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:27:24,735 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:27:24,740 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        37.21              89.08  24.04          0.05           0.04    0.04   2816
1        47.47              95.72  34.50          0.11           0.05    0.04   1574
2026-01-14 18:27:24,740 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:27:24,753 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban        Unknown          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:27:24,755 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:27:25,006 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:27:26,394 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:27:26,596 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:27:27,721 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:27:27,722 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:29:47,217 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:29:47,218 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:29:47,234 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:29:47,234 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:29:47,234 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:29:47,237 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:29:47,238 - INFO - START: processing column 'bmi'.
2026-01-14 18:29:47,240 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:29:47,241 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:29:47,242 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:29:47,243 - INFO - START: processing column 'age'.
2026-01-14 18:29:47,244 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:29:47,244 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:29:47,246 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:29:47,246 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:29:47,247 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:29:47,247 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:29:47,296 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:29:47,302 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:29:47,303 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:29:47,303 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:29:47,332 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:29:47,336 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:29:47,338 - INFO - Running full analysis pipeline...
2026-01-14 18:29:47,339 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:29:47,352 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:29:47,373 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:29:47,387 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:29:47,387 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:29:47,397 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:29:47,401 - INFO - ==================================================
2026-01-14 18:29:47,401 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:29:47,402 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:29:47,402 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:29:47,403 - INFO - ==================================================
2026-01-14 18:29:47,428 - INFO - Generating visualizations...
2026-01-14 18:29:47,428 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:29:47,429 - INFO - Generating Stacked Bar Chart
2026-01-14 18:29:48,187 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:29:48,187 - INFO - Generating Mosaic Plot...
2026-01-14 18:29:48,660 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:29:48,661 - INFO - Generating Residuals Heatmap...
2026-01-14 18:29:48,976 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:29:48,977 - INFO - Generating Forest Plot...
2026-01-14 18:29:49,246 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:29:49,246 - INFO - Generating Lollipop Plot...
2026-01-14 18:29:49,486 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:29:49,487 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:29:49,487 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:29:49,487 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:29:49,487 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:29:49,490 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:29:49,490 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:29:49,491 - INFO - Preparing data for optimization analysis...
2026-01-14 18:29:49,504 - INFO - Calculating metrics for each K...
2026-01-14 18:29:49,504 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:29:49,505 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:29:51,029 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:29:51,030 - INFO - START: Generating PCA Visualization.
2026-01-14 18:29:51,234 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:29:54,356 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:29:54,357 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:29:54,361 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:29:54,362 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:29:54,375 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:29:54,378 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:29:54,566 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:29:56,237 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:29:56,439 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:29:57,931 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:29:57,931 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:31:07,280 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:31:07,281 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:31:07,290 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:31:07,291 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:31:07,291 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:31:07,292 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:31:07,293 - INFO - START: processing column 'bmi'.
2026-01-14 18:31:07,294 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:31:07,294 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:31:07,296 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:31:07,296 - INFO - START: processing column 'age'.
2026-01-14 18:31:07,297 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:31:07,297 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:31:07,299 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:31:07,300 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:31:07,300 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:31:07,300 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:31:07,337 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:31:07,343 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:31:07,344 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:31:07,344 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:31:07,354 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:31:07,355 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:31:07,356 - INFO - Running full analysis pipeline...
2026-01-14 18:31:07,356 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:31:07,362 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:31:07,363 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:31:07,368 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:31:07,368 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:31:07,374 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:31:07,376 - INFO - ==================================================
2026-01-14 18:31:07,376 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:31:07,377 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:31:07,377 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:31:07,377 - INFO - ==================================================
2026-01-14 18:31:07,393 - INFO - Generating visualizations...
2026-01-14 18:31:07,394 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:31:07,394 - INFO - Generating Stacked Bar Chart
2026-01-14 18:31:07,925 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:31:07,925 - INFO - Generating Mosaic Plot...
2026-01-14 18:31:08,397 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 18:31:08,397 - INFO - Generating Residuals Heatmap...
2026-01-14 18:31:08,709 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:31:08,709 - INFO - Generating Forest Plot...
2026-01-14 18:31:08,993 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:31:08,994 - INFO - Generating Lollipop Plot...
2026-01-14 18:31:09,237 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:31:09,238 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:31:09,238 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:31:09,238 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:31:09,238 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:31:09,240 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:31:09,240 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:31:09,241 - INFO - Preparing data for optimization analysis...
2026-01-14 18:31:09,251 - INFO - Calculating metrics for each K...
2026-01-14 18:31:09,252 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:31:09,252 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:31:10,768 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:31:10,768 - INFO - START: Generating PCA Visualization.
2026-01-14 18:31:10,957 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:31:15,600 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:31:15,600 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:31:15,605 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:31:15,606 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:31:15,620 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:31:15,622 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:31:15,845 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:31:17,403 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:31:17,635 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:31:19,079 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:31:19,079 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:39:10,137 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:39:10,137 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:39:10,148 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:39:10,148 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:39:10,149 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:39:10,150 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:39:10,150 - INFO - START: processing column 'bmi'.
2026-01-14 18:39:10,151 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:39:10,152 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:39:10,152 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:39:10,153 - INFO - START: processing column 'age'.
2026-01-14 18:39:10,154 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:39:10,154 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:39:10,156 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:39:10,156 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:39:10,157 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:39:10,157 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:39:10,193 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:39:10,197 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:39:10,197 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:39:10,198 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:39:10,208 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:39:10,209 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:39:10,210 - INFO - Running full analysis pipeline...
2026-01-14 18:39:10,210 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:39:10,216 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:39:10,216 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:39:10,224 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:39:10,225 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:39:10,231 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:39:10,233 - INFO - ==================================================
2026-01-14 18:39:10,233 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:39:10,233 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:39:10,233 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:39:10,234 - INFO - ==================================================
2026-01-14 18:39:10,243 - INFO - Generating visualizations...
2026-01-14 18:39:10,243 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:39:10,243 - INFO - Generating Stacked Bar Chart
2026-01-14 18:39:10,789 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:39:10,789 - INFO - Generating Mosaic Plot...
2026-01-14 18:39:10,919 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 18:39:10,920 - INFO - Generating Residuals Heatmap...
2026-01-14 18:39:11,224 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:39:11,225 - INFO - Generating Forest Plot...
2026-01-14 18:39:11,514 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:39:11,514 - INFO - Generating Lollipop Plot...
2026-01-14 18:39:11,754 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:39:11,754 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:39:11,755 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:39:11,755 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:39:11,755 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:39:11,757 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:39:11,758 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:39:11,758 - INFO - Preparing data for optimization analysis...
2026-01-14 18:39:11,773 - INFO - Calculating metrics for each K...
2026-01-14 18:39:11,773 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:39:11,774 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:39:13,300 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:39:13,301 - INFO - START: Generating PCA Visualization.
2026-01-14 18:39:13,488 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:39:19,621 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:39:19,621 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:39:19,626 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:39:19,626 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:39:19,639 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:39:19,641 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:39:19,870 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:39:26,583 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:39:26,766 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:39:33,761 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:39:33,761 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:43:53,583 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:43:53,584 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:43:53,592 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:43:53,592 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:43:53,593 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:43:53,595 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:43:53,595 - INFO - START: processing column 'bmi'.
2026-01-14 18:43:53,596 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:43:53,597 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:43:53,598 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:43:53,599 - INFO - START: processing column 'age'.
2026-01-14 18:43:53,600 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:43:53,600 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:43:53,602 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:43:53,602 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:43:53,603 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:43:53,603 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:43:53,654 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:43:53,665 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:43:53,666 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:43:53,666 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:43:53,684 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:43:53,687 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:43:53,688 - INFO - Running full analysis pipeline...
2026-01-14 18:43:53,689 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:43:53,702 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:43:53,703 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:43:53,715 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:43:53,716 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:43:53,730 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:43:53,733 - INFO - ==================================================
2026-01-14 18:43:53,734 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:43:53,735 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:43:53,735 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:43:53,736 - INFO - ==================================================
2026-01-14 18:43:53,753 - INFO - Generating visualizations...
2026-01-14 18:43:53,754 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:43:53,754 - INFO - Generating Stacked Bar Chart
2026-01-14 18:43:54,363 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:43:54,364 - INFO - Generating Mosaic Plot...
2026-01-14 18:43:54,527 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 18:43:54,527 - INFO - Generating Residuals Heatmap...
2026-01-14 18:43:54,828 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:43:54,829 - INFO - Generating Forest Plot...
2026-01-14 18:43:55,108 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:43:55,108 - INFO - Generating Lollipop Plot...
2026-01-14 18:43:55,353 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:43:55,353 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:43:55,353 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:43:55,353 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:43:55,353 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:43:55,355 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:43:55,356 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:43:55,356 - INFO - Preparing data for optimization analysis...
2026-01-14 18:43:55,366 - INFO - Calculating metrics for each K...
2026-01-14 18:43:55,367 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:43:55,367 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:43:56,882 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:43:56,883 - INFO - START: Generating PCA Visualization.
2026-01-14 18:43:57,056 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:43:59,546 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:43:59,547 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:43:59,552 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:43:59,553 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:43:59,569 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:43:59,571 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:43:59,896 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:44:01,012 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:44:01,187 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:44:02,371 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:44:02,371 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:48:22,572 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:48:22,572 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:48:22,581 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:48:22,581 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:48:22,582 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:48:22,584 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:48:22,584 - INFO - START: processing column 'bmi'.
2026-01-14 18:48:22,585 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:48:22,585 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:48:22,587 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:48:22,587 - INFO - START: processing column 'age'.
2026-01-14 18:48:22,588 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:48:22,589 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:48:22,590 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:48:22,591 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:48:22,591 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:48:22,591 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:48:22,637 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:48:22,645 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:48:22,645 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:48:22,646 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:48:22,667 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:48:22,668 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:48:22,668 - INFO - Running full analysis pipeline...
2026-01-14 18:48:22,669 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:48:22,674 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:48:22,674 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:48:22,680 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:48:22,681 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:48:22,688 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:48:22,692 - INFO - ==================================================
2026-01-14 18:48:22,692 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:48:22,693 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:48:22,693 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:48:22,694 - INFO - ==================================================
2026-01-14 18:48:22,705 - INFO - Generating visualizations...
2026-01-14 18:48:22,705 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:48:22,705 - INFO - Generating Stacked Bar Chart
2026-01-14 18:48:23,254 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:48:23,254 - INFO - Generating Mosaic Plot...
2026-01-14 18:48:23,386 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 18:48:23,386 - INFO - Generating Residuals Heatmap...
2026-01-14 18:48:23,700 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:48:23,701 - INFO - Generating Forest Plot...
2026-01-14 18:48:24,012 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:48:24,012 - INFO - Generating Lollipop Plot...
2026-01-14 18:48:24,314 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:48:24,314 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:48:24,314 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:48:24,314 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:48:24,315 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:48:24,316 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:48:24,317 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:48:24,317 - INFO - Preparing data for optimization analysis...
2026-01-14 18:48:24,336 - INFO - Calculating metrics for each K...
2026-01-14 18:48:24,336 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:48:24,336 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:48:25,863 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:48:25,863 - INFO - START: Generating PCA Visualization.
2026-01-14 18:48:26,070 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:48:29,506 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:48:29,506 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:48:29,511 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:48:29,512 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:48:29,526 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:48:29,529 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:48:29,719 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:48:31,048 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:48:31,226 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:48:32,189 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:48:32,189 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:49:20,512 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:49:20,512 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:49:20,522 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:49:20,522 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:49:20,522 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:49:20,524 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:49:20,524 - INFO - START: processing column 'bmi'.
2026-01-14 18:49:20,525 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:49:20,526 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:49:20,527 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:49:20,527 - INFO - START: processing column 'age'.
2026-01-14 18:49:20,529 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:49:20,529 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:49:20,531 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:49:20,532 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:49:20,532 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:49:20,533 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:49:20,577 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:49:20,582 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:49:20,582 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:49:20,582 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:49:20,591 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:49:20,593 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:49:20,594 - INFO - Running full analysis pipeline...
2026-01-14 18:49:20,594 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:49:20,601 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:49:20,601 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:49:20,607 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:49:20,607 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:49:20,611 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:49:20,613 - INFO - ==================================================
2026-01-14 18:49:20,614 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:49:20,614 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:49:20,614 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:49:20,614 - INFO - ==================================================
2026-01-14 18:49:20,623 - INFO - Generating visualizations...
2026-01-14 18:49:20,623 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:49:20,623 - INFO - Generating Stacked Bar Chart
2026-01-14 18:49:21,152 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:49:21,153 - INFO - Generating Mosaic Plot...
2026-01-14 18:49:21,302 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 18:49:21,302 - INFO - Generating Residuals Heatmap...
2026-01-14 18:49:21,661 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:49:21,661 - INFO - Generating Forest Plot...
2026-01-14 18:49:21,954 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:49:21,955 - INFO - Generating Lollipop Plot...
2026-01-14 18:49:22,213 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:49:22,213 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:49:22,213 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:49:22,213 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:49:22,213 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:49:22,215 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:49:22,215 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:49:22,216 - INFO - Preparing data for optimization analysis...
2026-01-14 18:49:22,227 - INFO - Calculating metrics for each K...
2026-01-14 18:49:22,228 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:49:22,229 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:49:23,780 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:49:23,780 - INFO - START: Generating PCA Visualization.
2026-01-14 18:49:24,057 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:49:27,965 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:49:27,966 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:49:27,971 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:49:27,971 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:49:27,985 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:49:27,989 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:49:28,250 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:49:29,595 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:49:29,773 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:49:30,890 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:49:30,890 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 18:50:32,480 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 18:50:32,480 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 18:50:32,490 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 18:50:32,490 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 18:50:32,490 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 18:50:32,492 - INFO - Successfully dropped columns: ['id']
2026-01-14 18:50:32,492 - INFO - START: processing column 'bmi'.
2026-01-14 18:50:32,493 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 18:50:32,494 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 18:50:32,495 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 18:50:32,496 - INFO - START: processing column 'age'.
2026-01-14 18:50:32,496 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 18:50:32,497 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 18:50:32,498 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 18:50:32,499 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 18:50:32,499 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 18:50:32,499 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 18:50:32,541 - INFO - Successfully created 'risk_group' column.
2026-01-14 18:50:32,547 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 18:50:32,548 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 18:50:32,548 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 18:50:32,560 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 18:50:32,562 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 18:50:32,562 - INFO - Running full analysis pipeline...
2026-01-14 18:50:32,563 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 18:50:32,576 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 18:50:32,576 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 18:50:32,584 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 18:50:32,584 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 18:50:32,588 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 18:50:32,590 - INFO - ==================================================
2026-01-14 18:50:32,591 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 18:50:32,591 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 18:50:32,591 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 18:50:32,592 - INFO - ==================================================
2026-01-14 18:50:32,612 - INFO - Generating visualizations...
2026-01-14 18:50:32,612 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 18:50:32,612 - INFO - Generating Stacked Bar Chart
2026-01-14 18:50:33,136 - INFO - Saved: 1_stacked_bar.png
2026-01-14 18:50:33,137 - INFO - Generating Mosaic Plot...
2026-01-14 18:50:33,266 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 18:50:33,266 - INFO - Generating Residuals Heatmap...
2026-01-14 18:50:33,573 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 18:50:33,574 - INFO - Generating Forest Plot...
2026-01-14 18:50:33,861 - INFO - Saved: 4_forest_plot.png
2026-01-14 18:50:33,862 - INFO - Generating Lollipop Plot...
2026-01-14 18:50:34,104 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 18:50:34,105 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 18:50:34,106 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 18:50:34,106 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 18:50:34,106 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 18:50:34,108 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 18:50:34,109 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 18:50:34,109 - INFO - Preparing data for optimization analysis...
2026-01-14 18:50:34,119 - INFO - Calculating metrics for each K...
2026-01-14 18:50:34,119 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 18:50:34,119 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 18:50:35,659 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 18:50:35,659 - INFO - START: Generating PCA Visualization.
2026-01-14 18:50:35,842 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 18:50:38,785 - INFO - START: Generating Cluster Profile Report...
2026-01-14 18:50:38,786 - INFO - Calculating numeric averages (Profile):
2026-01-14 18:50:38,791 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 18:50:38,791 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 18:50:38,807 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 18:50:38,809 - INFO - START: Generating Risk Bar Chart.
2026-01-14 18:50:38,993 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 18:50:40,669 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 18:50:40,834 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 18:50:42,026 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 18:50:42,026 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:01:06,502 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:01:06,502 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:01:06,514 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:01:06,515 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:01:06,515 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:01:06,516 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:01:06,516 - INFO - START: processing column 'bmi'.
2026-01-14 19:01:06,517 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:01:06,518 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:01:06,519 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:01:06,520 - INFO - START: processing column 'age'.
2026-01-14 19:01:06,521 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:01:06,521 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:01:06,523 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:01:06,524 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:01:06,524 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:01:06,524 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:01:06,563 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:01:06,567 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:01:06,568 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:01:06,568 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:01:06,576 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:01:06,578 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:01:06,578 - INFO - Running full analysis pipeline...
2026-01-14 19:01:06,579 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:01:06,584 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:01:06,584 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:01:06,591 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:01:06,591 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:01:06,596 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:01:06,597 - INFO - ==================================================
2026-01-14 19:01:06,598 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:01:06,598 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:01:06,598 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:01:06,599 - INFO - ==================================================
2026-01-14 19:01:06,609 - INFO - Generating visualizations...
2026-01-14 19:01:06,610 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:01:06,610 - INFO - Generating Stacked Bar Chart
2026-01-14 19:01:07,109 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:01:07,110 - INFO - Generating Mosaic Plot...
2026-01-14 19:01:07,272 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 19:01:07,272 - INFO - Generating Residuals Heatmap...
2026-01-14 19:01:07,569 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:01:07,569 - INFO - Generating Forest Plot...
2026-01-14 19:01:07,887 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:01:07,887 - INFO - Generating Lollipop Plot...
2026-01-14 19:01:08,132 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:01:08,133 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:01:08,133 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:01:08,133 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:01:08,133 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:01:08,135 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:01:08,135 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:01:08,135 - INFO - Preparing data for optimization analysis...
2026-01-14 19:01:08,153 - INFO - Calculating metrics for each K...
2026-01-14 19:01:08,153 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:01:08,153 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:01:09,751 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:01:09,751 - INFO - START: Generating PCA Visualization.
2026-01-14 19:01:09,943 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:01:12,684 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:01:12,685 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:01:12,690 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:01:12,690 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:01:12,705 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:01:12,708 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:01:12,917 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:01:14,409 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:01:14,629 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:01:17,375 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:01:17,376 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:03:19,891 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:03:19,892 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:03:19,904 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:03:19,904 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:03:19,905 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:03:19,906 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:03:19,907 - INFO - START: processing column 'bmi'.
2026-01-14 19:03:19,908 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:03:19,908 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:03:19,910 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:03:19,910 - INFO - START: processing column 'age'.
2026-01-14 19:03:19,911 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:03:19,912 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:03:19,914 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:03:19,915 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:03:19,915 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:03:19,915 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:03:19,954 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:03:19,958 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:03:19,959 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:03:19,959 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:03:19,970 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:03:19,971 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:03:19,971 - INFO - Running full analysis pipeline...
2026-01-14 19:03:19,972 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:03:19,977 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:03:19,978 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:03:19,984 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:03:19,985 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:03:19,989 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:03:19,991 - INFO - ==================================================
2026-01-14 19:03:19,991 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:03:19,991 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:03:19,992 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:03:19,992 - INFO - ==================================================
2026-01-14 19:03:20,006 - INFO - Generating visualizations...
2026-01-14 19:03:20,006 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:03:20,006 - INFO - Generating Stacked Bar Chart
2026-01-14 19:03:20,538 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:03:20,539 - INFO - Generating Mosaic Plot...
2026-01-14 19:03:20,712 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 19:03:20,713 - INFO - Generating Residuals Heatmap...
2026-01-14 19:03:21,129 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:03:21,129 - INFO - Generating Forest Plot...
2026-01-14 19:03:21,471 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:03:21,471 - INFO - Generating Lollipop Plot...
2026-01-14 19:03:21,845 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:03:21,846 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:03:21,846 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:03:21,846 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:03:21,846 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:03:21,848 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:03:21,848 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:03:21,849 - INFO - Preparing data for optimization analysis...
2026-01-14 19:03:26,538 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:03:26,539 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:03:26,548 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:03:26,548 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:03:26,548 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:03:26,550 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:03:26,550 - INFO - START: processing column 'bmi'.
2026-01-14 19:03:26,551 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:03:26,552 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:03:26,553 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:03:26,554 - INFO - START: processing column 'age'.
2026-01-14 19:03:26,555 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:03:26,555 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:03:26,557 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:03:26,557 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:03:26,557 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:03:26,558 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:03:26,595 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:03:26,599 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:03:26,600 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:03:26,600 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:03:26,614 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:03:26,616 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:03:26,616 - INFO - Running full analysis pipeline...
2026-01-14 19:03:26,616 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:03:26,621 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:03:26,622 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:03:26,626 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:03:26,626 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:03:26,631 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:03:26,632 - INFO - ==================================================
2026-01-14 19:03:26,633 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:03:26,633 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:03:26,634 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:03:26,634 - INFO - ==================================================
2026-01-14 19:03:26,644 - INFO - Generating visualizations...
2026-01-14 19:03:26,644 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:03:26,645 - INFO - Generating Stacked Bar Chart
2026-01-14 19:03:27,132 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:03:27,133 - INFO - Generating Mosaic Plot...
2026-01-14 19:03:27,265 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 19:03:27,266 - INFO - Generating Residuals Heatmap...
2026-01-14 19:03:27,576 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:03:27,576 - INFO - Generating Forest Plot...
2026-01-14 19:03:27,877 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:03:27,877 - INFO - Generating Lollipop Plot...
2026-01-14 19:03:28,199 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:03:28,199 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:03:28,199 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:03:28,199 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:03:28,200 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:03:28,201 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:03:28,202 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:03:28,202 - INFO - Preparing data for optimization analysis...
2026-01-14 19:03:28,216 - INFO - Calculating metrics for each K...
2026-01-14 19:03:28,217 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:03:28,217 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:03:29,824 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:03:29,825 - INFO - START: Generating PCA Visualization.
2026-01-14 19:03:30,023 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:03:38,458 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:03:38,458 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:03:38,463 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:03:38,463 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:03:38,477 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:03:38,480 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:03:38,791 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:03:40,468 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:03:40,645 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:03:41,702 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:03:41,702 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:07:10,048 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:07:10,049 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:07:10,058 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:07:10,058 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:07:10,058 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:07:10,060 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:07:10,060 - INFO - START: processing column 'bmi'.
2026-01-14 19:07:10,061 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:07:10,061 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:07:10,063 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:07:10,063 - INFO - START: processing column 'age'.
2026-01-14 19:07:10,064 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:07:10,064 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:07:10,066 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:07:10,067 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:07:10,067 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:07:10,067 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:07:10,102 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:07:10,107 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:07:10,108 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:07:10,108 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:07:10,115 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:07:10,117 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:07:10,117 - INFO - Running full analysis pipeline...
2026-01-14 19:07:10,118 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:07:10,122 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:07:10,123 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:07:10,126 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:07:10,127 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:07:10,131 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:07:10,132 - INFO - ==================================================
2026-01-14 19:07:10,133 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:07:10,133 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:07:10,134 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:07:10,134 - INFO - ==================================================
2026-01-14 19:07:10,142 - INFO - Generating visualizations...
2026-01-14 19:07:10,142 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:07:10,142 - INFO - Generating Stacked Bar Chart
2026-01-14 19:07:10,512 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:07:10,512 - INFO - Generating Mosaic Plot...
2026-01-14 19:07:10,606 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 19:07:10,606 - INFO - Generating Residuals Heatmap...
2026-01-14 19:07:10,867 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:07:10,867 - INFO - Generating Forest Plot...
2026-01-14 19:07:11,147 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:07:11,148 - INFO - Generating Lollipop Plot...
2026-01-14 19:07:11,351 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:07:11,351 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:07:11,351 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:07:11,351 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:07:11,351 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:07:11,353 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:07:11,353 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:07:11,353 - INFO - Preparing data for optimization analysis...
2026-01-14 19:07:11,363 - INFO - Calculating metrics for each K...
2026-01-14 19:07:11,364 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:07:11,364 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:07:12,834 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:07:12,834 - INFO - START: Generating PCA Visualization.
2026-01-14 19:07:13,005 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:07:15,709 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:07:15,709 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:07:15,713 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:07:15,713 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:07:15,725 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:07:15,728 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:07:15,875 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:07:17,302 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:07:17,438 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:07:18,955 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:07:18,955 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:09:59,804 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:09:59,804 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:09:59,814 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:09:59,814 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:09:59,814 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:09:59,816 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:09:59,817 - INFO - START: processing column 'bmi'.
2026-01-14 19:09:59,817 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:09:59,818 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:09:59,819 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:09:59,819 - INFO - START: processing column 'age'.
2026-01-14 19:09:59,820 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:09:59,821 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:09:59,823 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:09:59,823 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:09:59,824 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:09:59,824 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:09:59,868 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:09:59,874 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:09:59,875 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:09:59,876 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:09:59,888 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:09:59,890 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:09:59,890 - INFO - Running full analysis pipeline...
2026-01-14 19:09:59,890 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:09:59,896 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:09:59,897 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:09:59,914 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:09:59,915 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:09:59,922 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:09:59,925 - INFO - ==================================================
2026-01-14 19:09:59,925 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:09:59,926 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:09:59,926 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:09:59,927 - INFO - ==================================================
2026-01-14 19:09:59,952 - INFO - Generating visualizations...
2026-01-14 19:09:59,952 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:09:59,953 - INFO - Generating Stacked Bar Chart
2026-01-14 19:10:00,552 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:10:00,552 - INFO - Generating Mosaic Plot...
2026-01-14 19:10:00,689 - ERROR - Mosaic Plot Error: mosaic() got an unexpected keyword argument 'label_props'
2026-01-14 19:10:00,690 - INFO - Generating Residuals Heatmap...
2026-01-14 19:10:00,986 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:10:00,986 - INFO - Generating Forest Plot...
2026-01-14 19:10:01,264 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:10:01,264 - INFO - Generating Lollipop Plot...
2026-01-14 19:10:01,496 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:10:01,497 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:10:01,497 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:10:01,497 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:10:01,497 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:10:01,499 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:10:01,499 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:10:01,499 - INFO - Preparing data for optimization analysis...
2026-01-14 19:10:01,511 - INFO - Calculating metrics for each K...
2026-01-14 19:10:01,512 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:10:01,512 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:10:03,032 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:10:03,032 - INFO - START: Generating PCA Visualization.
2026-01-14 19:10:03,236 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:10:05,914 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:10:05,914 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:10:05,920 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:10:05,920 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:10:05,941 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:10:05,944 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:10:06,179 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:10:07,780 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:10:07,942 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:10:09,091 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:10:09,092 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:13:15,034 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:13:15,035 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:13:15,050 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:13:15,051 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:13:15,051 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:13:15,053 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:13:15,053 - INFO - START: processing column 'bmi'.
2026-01-14 19:13:15,055 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:13:15,055 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:13:15,056 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:13:15,056 - INFO - START: processing column 'age'.
2026-01-14 19:13:15,057 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:13:15,058 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:13:15,060 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:13:15,061 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:13:15,061 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:13:15,061 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:13:15,106 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:13:15,114 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:13:15,115 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:13:15,116 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:13:15,132 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:13:15,134 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:13:15,134 - INFO - Running full analysis pipeline...
2026-01-14 19:13:15,135 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:13:15,139 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:13:15,140 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:13:15,145 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:13:15,147 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:13:15,154 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:13:15,156 - INFO - ==================================================
2026-01-14 19:13:15,157 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:13:15,157 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:13:15,157 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:13:15,158 - INFO - ==================================================
2026-01-14 19:13:15,172 - INFO - Generating visualizations...
2026-01-14 19:13:15,173 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:13:15,173 - INFO - Generating Stacked Bar Chart
2026-01-14 19:13:15,694 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:13:15,695 - INFO - Generating Mosaic Plot...
2026-01-14 19:13:16,109 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:13:16,109 - INFO - Generating Residuals Heatmap...
2026-01-14 19:13:16,435 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:13:16,435 - INFO - Generating Forest Plot...
2026-01-14 19:13:16,730 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:13:16,730 - INFO - Generating Lollipop Plot...
2026-01-14 19:13:16,977 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:13:16,978 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:13:16,978 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:13:16,978 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:13:16,978 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:13:16,980 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:13:16,981 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:13:16,981 - INFO - Preparing data for optimization analysis...
2026-01-14 19:13:16,996 - INFO - Calculating metrics for each K...
2026-01-14 19:13:16,997 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:13:16,997 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:13:18,609 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:13:18,610 - INFO - START: Generating PCA Visualization.
2026-01-14 19:13:18,902 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:13:22,689 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:13:22,690 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:13:22,695 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:13:22,696 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:13:22,711 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:13:22,715 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:13:22,917 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:13:24,192 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:13:24,379 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:13:25,527 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:13:25,528 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:15:33,029 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:15:33,029 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:15:33,046 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:15:33,046 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:15:33,047 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:15:33,048 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:15:33,049 - INFO - START: processing column 'bmi'.
2026-01-14 19:15:33,050 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:15:33,051 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:15:33,053 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:15:33,054 - INFO - START: processing column 'age'.
2026-01-14 19:15:33,057 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:15:33,058 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:15:33,061 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:15:33,064 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:15:33,065 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:15:33,065 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:15:33,132 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:15:33,140 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:15:33,140 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:15:33,141 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:15:33,159 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:15:33,162 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:15:33,163 - INFO - Running full analysis pipeline...
2026-01-14 19:15:33,163 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:15:33,169 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:15:33,170 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:15:33,175 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:15:33,175 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:15:33,179 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:15:33,181 - INFO - ==================================================
2026-01-14 19:15:33,181 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:15:33,181 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:15:33,182 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:15:33,182 - INFO - ==================================================
2026-01-14 19:15:33,193 - INFO - Generating visualizations...
2026-01-14 19:15:33,193 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:15:33,194 - INFO - Generating Stacked Bar Chart
2026-01-14 19:15:33,727 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:15:33,727 - INFO - Generating Mosaic Plot...
2026-01-14 19:15:34,071 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:15:34,072 - INFO - Generating Residuals Heatmap...
2026-01-14 19:15:34,402 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:15:34,403 - INFO - Generating Forest Plot...
2026-01-14 19:15:34,684 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:15:34,685 - INFO - Generating Lollipop Plot...
2026-01-14 19:15:34,939 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:15:34,939 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:15:34,939 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:15:34,940 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:15:34,940 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:15:34,943 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:15:34,943 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:15:34,944 - INFO - Preparing data for optimization analysis...
2026-01-14 19:15:34,957 - INFO - Calculating metrics for each K...
2026-01-14 19:15:34,958 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:15:34,958 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:15:36,478 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:15:36,479 - INFO - START: Generating PCA Visualization.
2026-01-14 19:15:36,681 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:15:40,675 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:15:40,676 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:15:40,682 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:15:40,682 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:15:40,699 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:15:40,702 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:15:40,941 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:15:44,347 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:15:44,530 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:15:47,327 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:15:47,327 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:18:19,510 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:18:19,510 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:18:19,520 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:18:19,520 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:18:19,520 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:18:19,522 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:18:19,523 - INFO - START: processing column 'bmi'.
2026-01-14 19:18:19,524 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:18:19,524 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:18:19,526 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:18:19,527 - INFO - START: processing column 'age'.
2026-01-14 19:18:19,529 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:18:19,530 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:18:19,531 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:18:19,532 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:18:19,533 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:18:19,533 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:18:19,575 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:18:19,582 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:18:19,584 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:18:19,585 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:18:19,598 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:18:19,600 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:18:19,600 - INFO - Running full analysis pipeline...
2026-01-14 19:18:19,600 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:18:19,605 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:18:19,605 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:18:19,610 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:18:19,610 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:18:19,616 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:18:19,618 - INFO - ==================================================
2026-01-14 19:18:19,618 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:18:19,618 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:18:19,619 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:18:19,619 - INFO - ==================================================
2026-01-14 19:18:19,629 - INFO - Generating visualizations...
2026-01-14 19:18:19,629 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:18:19,629 - INFO - Generating Stacked Bar Chart
2026-01-14 19:18:20,182 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:18:20,182 - INFO - Generating Mosaic Plot...
2026-01-14 19:18:20,575 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:18:20,575 - INFO - Generating Residuals Heatmap...
2026-01-14 19:18:21,133 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:18:21,134 - INFO - Generating Forest Plot...
2026-01-14 19:18:21,484 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:18:21,485 - INFO - Generating Lollipop Plot...
2026-01-14 19:18:21,785 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:18:21,785 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:18:21,786 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:18:21,786 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:18:21,786 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:18:21,788 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:18:21,789 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:18:21,789 - INFO - Preparing data for optimization analysis...
2026-01-14 19:18:21,804 - INFO - Calculating metrics for each K...
2026-01-14 19:18:21,806 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:18:21,807 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:18:23,417 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:18:23,418 - INFO - START: Generating PCA Visualization.
2026-01-14 19:18:23,739 - INFO - SUCCESS: PCA Plot generated.
2026-01-14 19:18:25,617 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:18:25,618 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:18:25,623 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:18:25,623 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:18:25,640 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:18:25,643 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:18:25,851 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:18:27,100 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:18:27,293 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:18:28,311 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:18:28,312 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:22:47,708 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:22:47,708 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:22:47,719 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:22:47,719 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:22:47,720 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:22:47,721 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:22:47,722 - INFO - START: processing column 'bmi'.
2026-01-14 19:22:47,724 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:22:47,724 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:22:47,725 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:22:47,725 - INFO - START: processing column 'age'.
2026-01-14 19:22:47,728 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:22:47,728 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:22:47,729 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:22:47,730 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:22:47,730 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:22:47,731 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:22:47,769 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:22:47,773 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:22:47,774 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:22:47,774 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:22:47,783 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:22:47,785 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:22:47,785 - INFO - Running full analysis pipeline...
2026-01-14 19:22:47,786 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:22:47,794 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:22:47,794 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:22:47,800 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:22:47,801 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:22:47,806 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:22:47,808 - INFO - ==================================================
2026-01-14 19:22:47,808 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:22:47,809 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:22:47,809 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:22:47,809 - INFO - ==================================================
2026-01-14 19:22:47,818 - INFO - Generating visualizations...
2026-01-14 19:22:47,819 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:22:47,819 - INFO - Generating Stacked Bar Chart
2026-01-14 19:22:48,375 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:22:48,376 - INFO - Generating Mosaic Plot...
2026-01-14 19:22:48,758 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:22:48,758 - INFO - Generating Residuals Heatmap...
2026-01-14 19:22:49,119 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:22:49,119 - INFO - Generating Forest Plot...
2026-01-14 19:22:49,427 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:22:49,427 - INFO - Generating Lollipop Plot...
2026-01-14 19:22:49,747 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:22:49,747 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:22:49,748 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:22:49,748 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:22:49,748 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:22:49,750 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:22:49,750 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:22:49,750 - INFO - Preparing data for optimization analysis...
2026-01-14 19:22:49,766 - INFO - Calculating metrics for each K...
2026-01-14 19:22:49,766 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:22:49,767 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:22:51,304 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:22:51,304 - INFO - START: Generating PCA Visualization.
2026-01-14 19:22:51,829 - INFO - Saved: plot_clusters_pca
2026-01-14 19:22:51,830 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:22:51,830 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:22:51,834 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:22:51,835 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:22:51,847 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:22:51,849 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:22:52,015 - INFO - SUCCESS: Risk Chart generated.
2026-01-14 19:22:57,071 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:22:57,277 - INFO - SUCCESS: Capture Rate Chart generated.
2026-01-14 19:22:58,315 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:22:58,316 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:24:28,596 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:24:28,596 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:24:28,607 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:24:28,607 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:24:28,607 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:24:28,609 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:24:28,609 - INFO - START: processing column 'bmi'.
2026-01-14 19:24:28,611 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:24:28,611 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:24:28,612 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:24:28,612 - INFO - START: processing column 'age'.
2026-01-14 19:24:28,614 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:24:28,615 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:24:28,616 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:24:28,617 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:24:28,618 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:24:28,618 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:24:28,656 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:24:28,661 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:24:28,661 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:24:28,661 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:24:28,676 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:24:28,677 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:24:28,678 - INFO - Running full analysis pipeline...
2026-01-14 19:24:28,679 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:24:28,684 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:24:28,684 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:24:28,689 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:24:28,690 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:24:28,694 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:24:28,696 - INFO - ==================================================
2026-01-14 19:24:28,696 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:24:28,696 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:24:28,697 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:24:28,697 - INFO - ==================================================
2026-01-14 19:24:28,707 - INFO - Generating visualizations...
2026-01-14 19:24:28,707 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:24:28,708 - INFO - Generating Stacked Bar Chart
2026-01-14 19:24:29,297 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:24:29,298 - INFO - Generating Mosaic Plot...
2026-01-14 19:24:29,731 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:24:29,731 - INFO - Generating Residuals Heatmap...
2026-01-14 19:24:30,078 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:24:30,079 - INFO - Generating Forest Plot...
2026-01-14 19:24:30,385 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:24:30,385 - INFO - Generating Lollipop Plot...
2026-01-14 19:24:30,657 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:24:30,657 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:24:30,657 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:24:30,657 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:24:30,658 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:24:30,659 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:24:30,660 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:24:30,660 - INFO - Preparing data for optimization analysis...
2026-01-14 19:24:30,672 - INFO - Calculating metrics for each K...
2026-01-14 19:24:30,673 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:24:30,673 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:24:32,207 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:24:32,207 - INFO - START: Generating PCA Visualization.
2026-01-14 19:24:32,823 - INFO - Saved: plot_clusters_pca
2026-01-14 19:24:32,825 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:24:32,826 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:24:32,833 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:24:32,833 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:24:32,845 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:24:32,848 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:24:33,240 - INFO - Saved: plot_risk_analysis
2026-01-14 19:24:33,241 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:24:33,503 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 19:24:33,504 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:24:33,504 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:29:19,322 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:29:19,323 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:29:19,332 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:29:19,332 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:29:19,333 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:29:19,335 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:29:19,336 - INFO - START: processing column 'bmi'.
2026-01-14 19:29:19,337 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:29:19,338 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:29:19,339 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:29:19,339 - INFO - START: processing column 'age'.
2026-01-14 19:29:19,340 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:29:19,341 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:29:19,343 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:29:19,344 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:29:19,344 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:29:19,344 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:29:19,386 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:29:19,392 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:29:19,393 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:29:19,393 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:29:19,410 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:29:19,412 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:29:19,412 - INFO - Running full analysis pipeline...
2026-01-14 19:29:19,413 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:29:19,424 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:29:19,425 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:29:19,436 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:29:19,437 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:29:19,445 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:29:19,448 - INFO - ==================================================
2026-01-14 19:29:19,448 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:29:19,449 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:29:19,449 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:29:19,451 - INFO - ==================================================
2026-01-14 19:29:19,464 - INFO - Generating visualizations...
2026-01-14 19:29:19,464 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:29:19,465 - INFO - Generating Stacked Bar Chart
2026-01-14 19:29:19,991 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:29:19,992 - INFO - Generating Mosaic Plot...
2026-01-14 19:29:20,340 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:29:20,341 - INFO - Generating Residuals Heatmap...
2026-01-14 19:29:20,666 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:29:20,666 - INFO - Generating Forest Plot...
2026-01-14 19:29:20,952 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:29:20,952 - INFO - Generating Lollipop Plot...
2026-01-14 19:29:21,194 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:29:21,194 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:29:21,194 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:29:21,194 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:29:21,195 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:29:21,196 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:29:21,196 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:29:21,197 - INFO - Preparing data for optimization analysis...
2026-01-14 19:29:21,208 - INFO - Calculating metrics for each K...
2026-01-14 19:29:21,208 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:29:21,209 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:29:22,703 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:29:22,704 - INFO - START: Generating PCA Visualization.
2026-01-14 19:29:23,181 - INFO - Saved: plot_clusters_pca
2026-01-14 19:29:23,182 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:29:23,182 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:29:23,186 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:29:23,186 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:29:23,198 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:29:23,199 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:29:23,472 - INFO - Saved: plot_risk_analysis
2026-01-14 19:29:23,472 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:29:23,707 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 19:29:23,707 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:29:23,707 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:36:58,898 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:36:58,898 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:36:58,908 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:36:58,909 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:36:58,909 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:36:58,910 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:36:58,911 - INFO - START: processing column 'bmi'.
2026-01-14 19:36:58,912 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:36:58,912 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:36:58,913 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:36:58,913 - INFO - START: processing column 'age'.
2026-01-14 19:36:58,915 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:36:58,915 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:36:58,917 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:36:58,917 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:36:58,918 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:36:58,918 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:36:58,959 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:36:58,965 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:36:58,966 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:36:58,966 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:36:58,978 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:36:58,979 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:36:58,980 - INFO - Running full analysis pipeline...
2026-01-14 19:36:58,981 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:36:58,988 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:36:58,989 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:36:58,996 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:36:58,996 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:36:59,001 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:36:59,002 - INFO - ==================================================
2026-01-14 19:36:59,003 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:36:59,003 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:36:59,003 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:36:59,003 - INFO - ==================================================
2026-01-14 19:36:59,011 - INFO - Generating visualizations...
2026-01-14 19:36:59,011 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:36:59,012 - INFO - Generating Stacked Bar Chart
2026-01-14 19:36:59,477 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:36:59,477 - INFO - Generating Mosaic Plot...
2026-01-14 19:36:59,805 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:36:59,805 - INFO - Generating Residuals Heatmap...
2026-01-14 19:37:00,197 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:37:00,197 - INFO - Generating Forest Plot...
2026-01-14 19:37:00,591 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:37:00,591 - INFO - Generating Lollipop Plot...
2026-01-14 19:37:00,953 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:37:00,954 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:37:00,954 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:37:00,954 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:37:00,954 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:37:00,956 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:37:00,957 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:37:00,957 - INFO - Preparing data for optimization analysis...
2026-01-14 19:37:00,974 - INFO - Calculating metrics for each K...
2026-01-14 19:37:00,975 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:37:00,975 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:37:02,709 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:37:02,709 - INFO - START: Generating PCA Visualization.
2026-01-14 19:37:03,390 - INFO - Saved: plot_clusters_pca
2026-01-14 19:37:03,391 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:37:03,391 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:37:03,396 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:37:03,397 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:37:03,413 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:37:03,416 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:37:03,894 - INFO - Saved: plot_risk_analysis
2026-01-14 19:37:03,894 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:37:04,337 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 19:37:04,338 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:37:04,338 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:42:13,323 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:42:13,324 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:42:13,338 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:42:13,338 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:42:13,338 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:42:13,340 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:42:13,340 - INFO - START: processing column 'bmi'.
2026-01-14 19:42:13,341 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:42:13,341 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:42:13,342 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:42:13,344 - INFO - START: processing column 'age'.
2026-01-14 19:42:13,347 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:42:13,348 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:42:13,351 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:42:13,352 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:42:13,353 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:42:13,354 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:42:13,404 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:42:13,411 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:42:13,412 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:42:13,412 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:42:13,426 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:42:13,428 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:42:13,429 - INFO - Running full analysis pipeline...
2026-01-14 19:42:13,429 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:42:13,435 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:42:13,435 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:42:13,442 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:42:13,443 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:42:13,448 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:42:13,450 - INFO - ==================================================
2026-01-14 19:42:13,450 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:42:13,451 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:42:13,451 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:42:13,451 - INFO - ==================================================
2026-01-14 19:42:13,460 - INFO - Generating visualizations...
2026-01-14 19:42:13,460 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:42:13,461 - INFO - Generating Stacked Bar Chart
2026-01-14 19:42:14,014 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:42:14,014 - INFO - Generating Mosaic Plot...
2026-01-14 19:42:14,423 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:42:14,423 - INFO - Generating Residuals Heatmap...
2026-01-14 19:42:14,853 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:42:14,854 - INFO - Generating Forest Plot...
2026-01-14 19:42:15,196 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:42:15,197 - INFO - Generating Lollipop Plot...
2026-01-14 19:42:15,485 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:42:15,485 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:42:15,486 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:42:15,486 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:42:15,486 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:42:15,488 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:42:15,489 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:42:15,489 - INFO - Preparing data for optimization analysis...
2026-01-14 19:42:15,502 - INFO - Calculating metrics for each K...
2026-01-14 19:42:15,503 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:42:15,503 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:42:17,223 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:42:17,224 - INFO - START: Generating PCA Visualization.
2026-01-14 19:42:17,832 - INFO - Saved: plot_clusters_pca
2026-01-14 19:42:17,833 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:42:17,834 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:42:17,839 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:42:17,840 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:42:17,852 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:42:17,855 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:42:18,188 - INFO - Saved: plot_risk_analysis
2026-01-14 19:42:18,188 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:42:18,491 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 19:42:18,491 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:42:18,491 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:44:54,147 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:44:54,148 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:44:54,159 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:44:54,159 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:44:54,160 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:44:54,161 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:44:54,162 - INFO - START: processing column 'bmi'.
2026-01-14 19:44:54,163 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:44:54,163 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:44:54,164 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:44:54,164 - INFO - START: processing column 'age'.
2026-01-14 19:44:54,166 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:44:54,166 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:44:54,168 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:44:54,169 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:44:54,169 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:44:54,169 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:44:54,207 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:44:54,212 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:44:54,213 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:44:54,213 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:44:54,224 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:44:54,226 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:44:54,226 - INFO - Running full analysis pipeline...
2026-01-14 19:44:54,226 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:44:54,233 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:44:54,234 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:44:54,240 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:44:54,241 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:44:54,246 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:44:54,248 - INFO - ==================================================
2026-01-14 19:44:54,248 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:44:54,248 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:44:54,249 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:44:54,249 - INFO - ==================================================
2026-01-14 19:44:54,257 - INFO - Generating visualizations...
2026-01-14 19:44:54,258 - INFO - Running full analysis pipeline...
2026-01-14 19:44:54,258 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:44:54,266 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:44:54,267 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:44:54,273 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:44:54,274 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:44:54,279 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:44:54,280 - INFO - ==================================================
2026-01-14 19:44:54,281 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:44:54,281 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:44:54,281 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:44:54,282 - INFO - ==================================================
2026-01-14 19:44:54,282 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:44:54,282 - INFO - Generating Stacked Bar Chart
2026-01-14 19:44:54,797 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:44:54,798 - INFO - Generating Mosaic Plot...
2026-01-14 19:44:55,150 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:44:55,151 - INFO - Generating Residuals Heatmap...
2026-01-14 19:44:55,486 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:44:55,487 - INFO - Generating Forest Plot...
2026-01-14 19:44:55,759 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:44:55,759 - INFO - Generating Lollipop Plot...
2026-01-14 19:44:56,016 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:44:56,016 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:44:56,016 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:44:56,017 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:44:56,017 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:44:56,019 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:44:56,019 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:44:56,019 - INFO - Preparing data for optimization analysis...
2026-01-14 19:44:56,030 - INFO - Calculating metrics for each K...
2026-01-14 19:44:56,031 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 19:44:56,031 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:44:57,560 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:44:57,561 - INFO - START: Generating PCA Visualization.
2026-01-14 19:44:58,079 - INFO - Saved: plot_clusters_pca
2026-01-14 19:44:58,080 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:44:58,080 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:44:58,084 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:44:58,084 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:44:58,096 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:44:58,098 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:44:58,385 - INFO - Saved: plot_risk_analysis
2026-01-14 19:44:58,386 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:44:58,622 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 19:44:58,622 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:44:58,622 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 19:56:12,565 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 19:56:12,565 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 19:56:12,580 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 19:56:12,580 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 19:56:12,580 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 19:56:12,582 - INFO - Successfully dropped columns: ['id']
2026-01-14 19:56:12,582 - INFO - START: processing column 'bmi'.
2026-01-14 19:56:12,583 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 19:56:12,584 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 19:56:12,585 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 19:56:12,585 - INFO - START: processing column 'age'.
2026-01-14 19:56:12,587 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 19:56:12,587 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 19:56:12,589 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 19:56:12,590 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 19:56:12,591 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 19:56:12,591 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 19:56:12,634 - INFO - Successfully created 'risk_group' column.
2026-01-14 19:56:12,639 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 19:56:12,640 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 19:56:12,641 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 19:56:12,652 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 19:56:12,654 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 19:56:12,654 - INFO - Running full analysis pipeline...
2026-01-14 19:56:12,654 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:56:12,659 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:56:12,659 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:56:12,663 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:56:12,664 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:56:12,670 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:56:12,673 - INFO - ==================================================
2026-01-14 19:56:12,673 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:56:12,673 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:56:12,674 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:56:12,674 - INFO - ==================================================
2026-01-14 19:56:12,683 - INFO - Generating visualizations...
2026-01-14 19:56:12,684 - INFO - Running full analysis pipeline...
2026-01-14 19:56:12,684 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 19:56:12,689 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 19:56:12,689 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 19:56:12,694 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 19:56:12,695 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 19:56:12,699 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 19:56:12,701 - INFO - ==================================================
2026-01-14 19:56:12,702 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 19:56:12,702 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 19:56:12,702 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 19:56:12,703 - INFO - ==================================================
2026-01-14 19:56:12,703 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 19:56:12,703 - INFO - Generating Stacked Bar Chart
2026-01-14 19:56:13,278 - INFO - Saved: 1_stacked_bar.png
2026-01-14 19:56:13,279 - INFO - Generating Mosaic Plot...
2026-01-14 19:56:14,124 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 19:56:14,125 - INFO - Generating Residuals Heatmap...
2026-01-14 19:56:14,915 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 19:56:14,915 - INFO - Generating Forest Plot...
2026-01-14 19:56:15,354 - INFO - Saved: 4_forest_plot.png
2026-01-14 19:56:15,354 - INFO - Generating Lollipop Plot...
2026-01-14 19:56:15,669 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 19:56:15,670 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 19:56:15,671 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 19:56:15,671 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 19:56:15,671 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 19:56:15,674 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 19:56:15,675 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 19:56:15,675 - INFO - Preparing data for optimization analysis...
2026-01-14 19:56:15,689 - INFO - Calculating metrics for each K...
2026-01-14 19:56:22,195 - INFO - Generating Elbow plot...
2026-01-14 19:56:22,547 - INFO - Saved: Elbow Method
2026-01-14 19:56:22,547 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 19:56:22,548 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 19:56:22,589 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 19:56:22,589 - INFO - START: Generating PCA Visualization.
2026-01-14 19:56:23,138 - INFO - Saved: plot_clusters_pca
2026-01-14 19:56:23,139 - INFO - START: Generating Cluster Profile Report...
2026-01-14 19:56:23,140 - INFO - Calculating numeric averages (Profile):
2026-01-14 19:56:23,146 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 19:56:23,147 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 19:56:23,160 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 19:56:23,163 - INFO - START: Generating Risk Bar Chart.
2026-01-14 19:56:23,519 - INFO - Saved: plot_risk_analysis
2026-01-14 19:56:23,519 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 19:56:23,930 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 19:56:23,930 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 19:56:23,930 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:02:50,598 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:02:50,599 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:02:50,609 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:02:50,610 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:02:50,610 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:02:50,611 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:02:50,612 - INFO - START: processing column 'bmi'.
2026-01-14 20:02:50,613 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:02:50,614 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:02:50,615 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:02:50,615 - INFO - START: processing column 'age'.
2026-01-14 20:02:50,616 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:02:50,617 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:02:50,619 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:02:50,620 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:02:50,620 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:02:50,620 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:02:50,664 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:02:50,669 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:02:50,669 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:02:50,670 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:02:50,680 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:02:50,681 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:02:50,682 - INFO - Running full analysis pipeline...
2026-01-14 20:02:50,682 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:02:50,687 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:02:50,688 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:02:50,696 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:02:50,696 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:02:50,703 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:02:50,705 - INFO - ==================================================
2026-01-14 20:02:50,706 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:02:50,706 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:02:50,707 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:02:50,707 - INFO - ==================================================
2026-01-14 20:02:50,719 - INFO - Generating visualizations...
2026-01-14 20:02:50,720 - INFO - Running full analysis pipeline...
2026-01-14 20:02:50,721 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:02:50,728 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:02:50,728 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:02:50,736 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:02:50,737 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:02:50,743 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:02:50,745 - INFO - ==================================================
2026-01-14 20:02:50,745 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:02:50,746 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:02:50,746 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:02:50,746 - INFO - ==================================================
2026-01-14 20:02:50,746 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:02:50,747 - INFO - Generating Stacked Bar Chart
2026-01-14 20:02:51,237 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:02:51,237 - INFO - Generating Mosaic Plot...
2026-01-14 20:02:51,591 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:02:51,591 - INFO - Generating Residuals Heatmap...
2026-01-14 20:02:51,974 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:02:51,974 - INFO - Generating Forest Plot...
2026-01-14 20:02:52,311 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:02:52,312 - INFO - Generating Lollipop Plot...
2026-01-14 20:02:52,670 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:02:52,671 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:02:52,671 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:02:52,671 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:02:52,672 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:02:52,673 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:02:52,674 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:02:52,674 - INFO - Preparing data for optimization analysis...
2026-01-14 20:02:52,689 - INFO - Calculating metrics for each K...
2026-01-14 20:02:52,690 - ERROR - Optimization process failed: The 'n_clusters' parameter of KMeans must be an int in the range [1, inf). Got 0 instead.
2026-01-14 20:02:52,691 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:02:54,268 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:02:54,268 - INFO - START: Generating PCA Visualization.
2026-01-14 20:02:54,810 - INFO - Saved: plot_clusters_pca
2026-01-14 20:02:54,811 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:02:54,812 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:02:54,817 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:02:54,818 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:02:54,831 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:02:54,834 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:02:55,191 - INFO - Saved: plot_risk_analysis
2026-01-14 20:02:55,192 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:02:55,479 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:02:55,479 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:02:55,480 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:07:48,890 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:07:48,891 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:07:48,900 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:07:48,901 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:07:48,901 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:07:48,902 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:07:48,902 - INFO - START: processing column 'bmi'.
2026-01-14 20:07:48,903 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:07:48,904 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:07:48,905 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:07:48,906 - INFO - START: processing column 'age'.
2026-01-14 20:07:48,907 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:07:48,907 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:07:48,909 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:07:48,910 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:07:48,910 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:07:48,910 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:07:48,951 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:07:48,956 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:07:48,957 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:07:48,957 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:07:48,969 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:07:48,971 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:07:48,971 - INFO - Running full analysis pipeline...
2026-01-14 20:07:48,971 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:07:48,976 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:07:48,976 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:07:48,982 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:07:48,983 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:07:48,990 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:07:48,991 - INFO - ==================================================
2026-01-14 20:07:48,992 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:07:48,992 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:07:48,992 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:07:48,993 - INFO - ==================================================
2026-01-14 20:07:49,001 - INFO - Generating visualizations...
2026-01-14 20:07:49,002 - INFO - Running full analysis pipeline...
2026-01-14 20:07:49,002 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:07:49,006 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:07:49,007 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:07:49,011 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:07:49,012 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:07:49,016 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:07:49,019 - INFO - ==================================================
2026-01-14 20:07:49,020 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:07:49,020 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:07:49,021 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:07:49,021 - INFO - ==================================================
2026-01-14 20:07:49,021 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:07:49,021 - INFO - Generating Stacked Bar Chart
2026-01-14 20:07:49,569 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:07:49,569 - INFO - Generating Mosaic Plot...
2026-01-14 20:07:50,004 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:07:50,004 - INFO - Generating Residuals Heatmap...
2026-01-14 20:07:50,351 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:07:50,351 - INFO - Generating Forest Plot...
2026-01-14 20:07:50,663 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:07:50,663 - INFO - Generating Lollipop Plot...
2026-01-14 20:07:50,920 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:07:50,921 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:07:50,921 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:07:50,921 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:07:50,921 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:07:50,923 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:07:50,923 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:07:50,923 - INFO - Preparing data for optimization analysis...
2026-01-14 20:07:50,935 - INFO - Calculating metrics for each K...
2026-01-14 20:07:57,332 - INFO - Generating Elbow plot...
2026-01-14 20:07:57,631 - INFO - Saved: Elbow Method
2026-01-14 20:07:57,631 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:07:57,632 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:07:57,674 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:07:57,675 - INFO - START: Generating PCA Visualization.
2026-01-14 20:07:58,194 - INFO - Saved: plot_clusters_pca
2026-01-14 20:07:58,195 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:07:58,195 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:07:58,199 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:07:58,199 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:07:58,211 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:07:58,214 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:07:58,522 - INFO - Saved: plot_risk_analysis
2026-01-14 20:07:58,523 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:07:58,756 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:07:58,756 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:07:58,756 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:09:28,156 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:09:28,157 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:09:28,168 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:09:28,168 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:09:28,168 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:09:28,170 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:09:28,170 - INFO - START: processing column 'bmi'.
2026-01-14 20:09:28,172 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:09:28,172 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:09:28,174 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:09:28,175 - INFO - START: processing column 'age'.
2026-01-14 20:09:28,176 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:09:28,176 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:09:28,178 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:09:28,178 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:09:28,178 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:09:28,179 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:09:28,223 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:09:28,230 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:09:28,231 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:09:28,232 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:09:28,247 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:09:28,249 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:09:28,249 - INFO - Running full analysis pipeline...
2026-01-14 20:09:28,249 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:09:28,254 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:09:28,254 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:09:28,260 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:09:28,261 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:09:28,266 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:09:28,268 - INFO - ==================================================
2026-01-14 20:09:28,269 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:09:28,269 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:09:28,269 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:09:28,269 - INFO - ==================================================
2026-01-14 20:09:28,279 - INFO - Generating visualizations...
2026-01-14 20:09:28,279 - INFO - Running full analysis pipeline...
2026-01-14 20:09:28,279 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:09:28,283 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:09:28,284 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:09:28,289 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:09:28,289 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:09:28,294 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:09:28,296 - INFO - ==================================================
2026-01-14 20:09:28,296 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:09:28,296 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:09:28,297 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:09:28,297 - INFO - ==================================================
2026-01-14 20:09:28,297 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:09:28,298 - INFO - Generating Stacked Bar Chart
2026-01-14 20:09:28,833 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:09:28,833 - INFO - Generating Mosaic Plot...
2026-01-14 20:09:29,313 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:09:29,313 - INFO - Generating Residuals Heatmap...
2026-01-14 20:09:29,711 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:09:29,711 - INFO - Generating Forest Plot...
2026-01-14 20:09:30,153 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:09:30,154 - INFO - Generating Lollipop Plot...
2026-01-14 20:09:30,497 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:09:30,499 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:09:30,499 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:09:30,499 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:09:30,500 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:09:30,503 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:09:30,503 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:09:30,504 - INFO - Preparing data for optimization analysis...
2026-01-14 20:09:30,518 - INFO - Calculating metrics for each K...
2026-01-14 20:09:36,475 - INFO - Generating Elbow plot...
2026-01-14 20:09:36,839 - INFO - Saved: Elbow Method
2026-01-14 20:09:36,840 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:09:36,840 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:09:36,901 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:09:36,902 - INFO - START: Generating PCA Visualization.
2026-01-14 20:09:37,431 - INFO - Saved: plot_clusters_pca
2026-01-14 20:09:37,432 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:09:37,432 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:09:37,436 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:09:37,436 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:09:37,447 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:09:37,449 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:09:37,760 - INFO - Saved: plot_risk_analysis
2026-01-14 20:09:37,760 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:09:38,052 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:09:38,053 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:09:38,053 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:10:46,293 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:10:46,294 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:10:46,304 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:10:46,305 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:10:46,305 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:10:46,307 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:10:46,307 - INFO - START: processing column 'bmi'.
2026-01-14 20:10:46,308 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:10:46,309 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:10:46,310 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:10:46,310 - INFO - START: processing column 'age'.
2026-01-14 20:10:46,311 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:10:46,312 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:10:46,314 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:10:46,314 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:10:46,315 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:10:46,315 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:10:46,355 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:10:46,360 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:10:46,360 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:10:46,360 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:10:46,369 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:10:46,371 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:10:46,372 - INFO - Running full analysis pipeline...
2026-01-14 20:10:46,372 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:10:46,377 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:10:46,377 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:10:46,384 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:10:46,384 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:10:46,389 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:10:46,390 - INFO - ==================================================
2026-01-14 20:10:46,391 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:10:46,391 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:10:46,391 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:10:46,391 - INFO - ==================================================
2026-01-14 20:10:46,399 - INFO - Generating visualizations...
2026-01-14 20:10:46,399 - INFO - Running full analysis pipeline...
2026-01-14 20:10:46,399 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:10:46,404 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:10:46,405 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:10:46,410 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:10:46,411 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:10:46,417 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:10:46,418 - INFO - ==================================================
2026-01-14 20:10:46,418 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:10:46,418 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:10:46,419 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:10:46,419 - INFO - ==================================================
2026-01-14 20:10:46,419 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:10:46,420 - INFO - Generating Stacked Bar Chart
2026-01-14 20:10:46,908 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:10:46,909 - INFO - Generating Mosaic Plot...
2026-01-14 20:10:47,270 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:10:47,271 - INFO - Generating Residuals Heatmap...
2026-01-14 20:10:47,617 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:10:47,617 - INFO - Generating Forest Plot...
2026-01-14 20:10:47,924 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:10:47,925 - INFO - Generating Lollipop Plot...
2026-01-14 20:10:48,209 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:10:48,209 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:10:48,209 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:10:48,209 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:10:48,209 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:10:48,211 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:10:48,211 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:10:48,211 - INFO - Preparing data for optimization analysis...
2026-01-14 20:10:48,226 - INFO - Calculating metrics for each K...
2026-01-14 20:10:54,323 - INFO - Generating Elbow plot...
2026-01-14 20:10:54,773 - INFO - Saved: Elbow Method
2026-01-14 20:10:54,773 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:10:54,774 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:10:54,822 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:10:54,823 - INFO - START: Generating PCA Visualization.
2026-01-14 20:10:55,373 - INFO - Saved: plot_clusters_pca
2026-01-14 20:10:55,375 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:10:55,375 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:10:55,380 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:10:55,380 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:10:55,394 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:10:55,397 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:10:55,736 - INFO - Saved: plot_risk_analysis
2026-01-14 20:10:55,736 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:10:56,011 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:10:56,012 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:10:56,012 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:12:10,032 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:12:10,033 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:12:10,044 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:12:10,044 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:12:10,044 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:12:10,046 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:12:10,046 - INFO - START: processing column 'bmi'.
2026-01-14 20:12:10,048 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:12:10,048 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:12:10,049 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:12:10,050 - INFO - START: processing column 'age'.
2026-01-14 20:12:10,052 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:12:10,053 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:12:10,057 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:12:10,057 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:12:10,058 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:12:10,058 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:12:10,107 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:12:10,112 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:12:10,113 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:12:10,113 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:12:10,123 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:12:10,125 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:12:10,125 - INFO - Running full analysis pipeline...
2026-01-14 20:12:10,126 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:12:10,131 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:12:10,131 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:12:10,138 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:12:10,138 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:12:10,143 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:12:10,144 - INFO - ==================================================
2026-01-14 20:12:10,145 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:12:10,145 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:12:10,145 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:12:10,145 - INFO - ==================================================
2026-01-14 20:12:10,155 - INFO - Generating visualizations...
2026-01-14 20:12:10,155 - INFO - Running full analysis pipeline...
2026-01-14 20:12:10,155 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:12:10,163 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:12:10,164 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:12:10,170 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:12:10,170 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:12:10,175 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:12:10,177 - INFO - ==================================================
2026-01-14 20:12:10,177 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:12:10,178 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:12:10,178 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:12:10,178 - INFO - ==================================================
2026-01-14 20:12:10,178 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:12:10,179 - INFO - Generating Stacked Bar Chart
2026-01-14 20:12:10,758 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:12:10,758 - INFO - Generating Mosaic Plot...
2026-01-14 20:12:11,189 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:12:11,189 - INFO - Generating Residuals Heatmap...
2026-01-14 20:12:11,526 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:12:11,526 - INFO - Generating Forest Plot...
2026-01-14 20:12:11,827 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:12:11,827 - INFO - Generating Lollipop Plot...
2026-01-14 20:12:12,076 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:12:12,077 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:12:12,077 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:12:12,077 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:12:12,077 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:12:12,079 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:12:12,080 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:12:12,080 - INFO - Preparing data for optimization analysis...
2026-01-14 20:12:12,093 - INFO - Calculating metrics for each K...
2026-01-14 20:12:18,413 - INFO - Generating Elbow plot...
2026-01-14 20:12:18,698 - INFO - Saved: Elbow Method
2026-01-14 20:12:18,698 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:12:18,698 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:12:18,740 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:12:18,741 - INFO - START: Generating PCA Visualization.
2026-01-14 20:12:19,258 - INFO - Saved: plot_clusters_pca
2026-01-14 20:12:19,259 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:12:19,260 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:12:19,263 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:12:19,264 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:12:19,275 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:12:19,277 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:12:19,567 - INFO - Saved: plot_risk_analysis
2026-01-14 20:12:19,567 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:12:19,814 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:12:19,814 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:12:19,814 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:13:09,776 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:13:09,777 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:13:09,786 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:13:09,787 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:13:09,787 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:13:09,788 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:13:09,789 - INFO - START: processing column 'bmi'.
2026-01-14 20:13:09,790 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:13:09,790 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:13:09,791 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:13:09,792 - INFO - START: processing column 'age'.
2026-01-14 20:13:09,793 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:13:09,793 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:13:09,795 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:13:09,796 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:13:09,796 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:13:09,797 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:13:09,838 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:13:09,842 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:13:09,843 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:13:09,843 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:13:09,853 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:13:09,855 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:13:09,855 - INFO - Running full analysis pipeline...
2026-01-14 20:13:09,855 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:13:09,865 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:13:09,866 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:13:09,872 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:13:09,872 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:13:09,877 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:13:09,878 - INFO - ==================================================
2026-01-14 20:13:09,879 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:13:09,879 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:13:09,880 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:13:09,880 - INFO - ==================================================
2026-01-14 20:13:09,887 - INFO - Generating visualizations...
2026-01-14 20:13:09,888 - INFO - Running full analysis pipeline...
2026-01-14 20:13:09,888 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:13:09,893 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:13:09,893 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:13:09,897 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:13:09,898 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:13:09,902 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:13:09,904 - INFO - ==================================================
2026-01-14 20:13:09,904 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:13:09,904 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:13:09,904 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:13:09,904 - INFO - ==================================================
2026-01-14 20:13:09,905 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:13:09,905 - INFO - Generating Stacked Bar Chart
2026-01-14 20:13:10,417 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:13:10,418 - INFO - Generating Mosaic Plot...
2026-01-14 20:13:10,755 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:13:10,756 - INFO - Generating Residuals Heatmap...
2026-01-14 20:13:11,118 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:13:11,119 - INFO - Generating Forest Plot...
2026-01-14 20:13:11,401 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:13:11,401 - INFO - Generating Lollipop Plot...
2026-01-14 20:13:11,769 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:13:11,769 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:13:11,770 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:13:11,770 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:13:11,770 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:13:11,772 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:13:11,773 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:13:11,773 - INFO - Preparing data for optimization analysis...
2026-01-14 20:13:11,792 - INFO - Calculating metrics for each K...
2026-01-14 20:13:17,637 - INFO - Generating Elbow plot...
2026-01-14 20:13:18,040 - INFO - Saved: Elbow Method
2026-01-14 20:13:18,041 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:13:18,041 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:13:18,098 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:13:18,099 - INFO - START: Generating PCA Visualization.
2026-01-14 20:13:18,759 - INFO - Saved: plot_clusters_pca
2026-01-14 20:13:18,760 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:13:18,761 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:13:18,766 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:13:18,766 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:13:18,781 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:13:18,783 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:13:19,166 - INFO - Saved: plot_risk_analysis
2026-01-14 20:13:19,166 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:13:19,434 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:13:19,435 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:13:19,435 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:14:04,600 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:14:04,601 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:14:04,614 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:14:04,614 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:14:04,615 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:14:04,617 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:14:04,618 - INFO - START: processing column 'bmi'.
2026-01-14 20:14:04,621 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:14:04,622 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:14:04,623 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:14:04,624 - INFO - START: processing column 'age'.
2026-01-14 20:14:04,627 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:14:04,627 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:14:04,629 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:14:04,630 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:14:04,631 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:14:04,632 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:14:04,686 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:14:04,694 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:14:04,694 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:14:04,695 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:14:04,708 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:14:04,711 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:14:04,711 - INFO - Running full analysis pipeline...
2026-01-14 20:14:04,711 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:14:04,718 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:14:04,719 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:14:04,725 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:14:04,726 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:14:04,733 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:14:04,735 - INFO - ==================================================
2026-01-14 20:14:04,736 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:14:04,736 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:14:04,737 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:14:04,737 - INFO - ==================================================
2026-01-14 20:14:04,752 - INFO - Generating visualizations...
2026-01-14 20:14:04,752 - INFO - Running full analysis pipeline...
2026-01-14 20:14:04,753 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:14:04,762 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:14:04,762 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:14:04,768 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:14:04,769 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:14:04,776 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:14:04,778 - INFO - ==================================================
2026-01-14 20:14:04,779 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:14:04,779 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:14:04,779 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:14:04,779 - INFO - ==================================================
2026-01-14 20:14:04,780 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:14:04,780 - INFO - Generating Stacked Bar Chart
2026-01-14 20:14:05,618 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:14:05,618 - INFO - Generating Mosaic Plot...
2026-01-14 20:14:06,127 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:14:06,127 - INFO - Generating Residuals Heatmap...
2026-01-14 20:14:06,576 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:14:06,577 - INFO - Generating Forest Plot...
2026-01-14 20:14:06,950 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:14:06,951 - INFO - Generating Lollipop Plot...
2026-01-14 20:14:07,228 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:14:07,228 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:14:07,228 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:14:07,229 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:14:07,229 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:14:07,232 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:14:07,233 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:14:07,233 - INFO - Preparing data for optimization analysis...
2026-01-14 20:14:07,247 - INFO - Calculating metrics for each K...
2026-01-14 20:14:13,572 - INFO - Generating Elbow plot...
2026-01-14 20:14:13,929 - INFO - Saved: Elbow Method
2026-01-14 20:14:13,929 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:14:13,930 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:14:13,985 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:14:13,985 - INFO - START: Generating PCA Visualization.
2026-01-14 20:14:14,503 - INFO - Saved: plot_clusters_pca
2026-01-14 20:14:14,505 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:14:14,506 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:14:14,511 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:14:14,512 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:14:14,523 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:14:14,525 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:14:14,845 - INFO - Saved: plot_risk_analysis
2026-01-14 20:14:14,845 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:14:15,082 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:14:15,082 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:14:15,082 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:15:13,074 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:15:13,075 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:15:13,084 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:15:13,085 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:15:13,085 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:15:13,086 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:15:13,086 - INFO - START: processing column 'bmi'.
2026-01-14 20:15:13,088 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:15:13,088 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:15:13,089 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:15:13,089 - INFO - START: processing column 'age'.
2026-01-14 20:15:13,090 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:15:13,091 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:15:13,092 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:15:13,093 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:15:13,093 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:15:13,093 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:15:13,135 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:15:13,140 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:15:13,140 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:15:13,140 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:15:13,151 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:15:13,153 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:15:13,153 - INFO - Running full analysis pipeline...
2026-01-14 20:15:13,154 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:15:13,159 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:15:13,160 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:15:13,166 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:15:13,167 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:15:13,171 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:15:13,173 - INFO - ==================================================
2026-01-14 20:15:13,173 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:15:13,173 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:15:13,174 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:15:13,174 - INFO - ==================================================
2026-01-14 20:15:13,182 - INFO - Generating visualizations...
2026-01-14 20:15:13,182 - INFO - Running full analysis pipeline...
2026-01-14 20:15:13,182 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:15:13,186 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:15:13,187 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:15:13,195 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:15:13,196 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:15:13,202 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:15:13,204 - INFO - ==================================================
2026-01-14 20:15:13,204 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:15:13,204 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:15:13,204 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:15:13,204 - INFO - ==================================================
2026-01-14 20:15:13,205 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:15:13,205 - INFO - Generating Stacked Bar Chart
2026-01-14 20:15:13,777 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:15:13,777 - INFO - Generating Mosaic Plot...
2026-01-14 20:15:14,280 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:15:14,281 - INFO - Generating Residuals Heatmap...
2026-01-14 20:15:14,710 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:15:14,710 - INFO - Generating Forest Plot...
2026-01-14 20:15:15,084 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:15:15,085 - INFO - Generating Lollipop Plot...
2026-01-14 20:15:15,479 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:15:15,479 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:15:15,480 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:15:15,480 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:15:15,480 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:15:15,482 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:15:15,483 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:15:15,483 - INFO - Preparing data for optimization analysis...
2026-01-14 20:15:15,498 - INFO - Calculating metrics for each K...
2026-01-14 20:15:21,385 - INFO - Generating Elbow plot...
2026-01-14 20:15:21,687 - INFO - Saved: Elbow Method
2026-01-14 20:15:21,687 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:15:21,687 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:15:21,729 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:15:21,730 - INFO - START: Generating PCA Visualization.
2026-01-14 20:15:22,244 - INFO - Saved: plot_clusters_pca
2026-01-14 20:15:22,245 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:15:22,246 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:15:22,250 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:15:22,250 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:15:22,261 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:15:22,263 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:15:22,570 - INFO - Saved: plot_risk_analysis
2026-01-14 20:15:22,571 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:15:22,818 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:15:22,819 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:15:22,819 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:16:01,588 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:16:01,588 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:16:01,597 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:16:01,597 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:16:01,598 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:16:01,599 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:16:01,600 - INFO - START: processing column 'bmi'.
2026-01-14 20:16:01,601 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:16:01,601 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:16:01,603 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:16:01,603 - INFO - START: processing column 'age'.
2026-01-14 20:16:01,605 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:16:01,606 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:16:01,607 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:16:01,608 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:16:01,609 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:16:01,609 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:16:01,650 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:16:01,656 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:16:01,656 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:16:01,657 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:16:01,667 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:16:01,668 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:16:01,669 - INFO - Running full analysis pipeline...
2026-01-14 20:16:01,669 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:16:01,675 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:16:01,676 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:16:01,682 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:16:01,682 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:16:01,686 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:16:01,689 - INFO - ==================================================
2026-01-14 20:16:01,689 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:16:01,689 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:16:01,690 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:16:01,690 - INFO - ==================================================
2026-01-14 20:16:01,698 - INFO - Generating visualizations...
2026-01-14 20:16:01,698 - INFO - Running full analysis pipeline...
2026-01-14 20:16:01,699 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:16:01,702 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:16:01,703 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:16:01,712 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:16:01,713 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:16:01,719 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:16:01,720 - INFO - ==================================================
2026-01-14 20:16:01,721 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:16:01,721 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:16:01,721 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:16:01,722 - INFO - ==================================================
2026-01-14 20:16:01,722 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:16:01,722 - INFO - Generating Stacked Bar Chart
2026-01-14 20:16:02,290 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:16:02,290 - INFO - Generating Mosaic Plot...
2026-01-14 20:16:02,745 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:16:02,745 - INFO - Generating Residuals Heatmap...
2026-01-14 20:16:03,206 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:16:03,206 - INFO - Generating Forest Plot...
2026-01-14 20:16:03,558 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:16:03,558 - INFO - Generating Lollipop Plot...
2026-01-14 20:16:03,972 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:16:03,972 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:16:03,973 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:16:03,973 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:16:03,973 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:16:03,976 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:16:03,976 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:16:03,977 - INFO - Preparing data for optimization analysis...
2026-01-14 20:16:03,992 - INFO - Calculating metrics for each K...
2026-01-14 20:16:10,463 - INFO - Generating Elbow plot...
2026-01-14 20:16:10,805 - INFO - Saved: Elbow Method
2026-01-14 20:16:10,806 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:16:10,806 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:16:10,868 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:16:10,869 - INFO - START: Generating PCA Visualization.
2026-01-14 20:16:11,453 - INFO - Saved: plot_clusters_pca
2026-01-14 20:16:11,455 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:16:11,455 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:16:11,460 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:16:11,460 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:16:11,477 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:16:11,480 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:16:11,820 - INFO - Saved: plot_risk_analysis
2026-01-14 20:16:11,821 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:16:12,040 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:16:12,041 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:16:12,041 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:19:47,037 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:19:47,038 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:19:47,047 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:19:47,048 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:19:47,048 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:19:47,049 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:19:47,050 - INFO - START: processing column 'bmi'.
2026-01-14 20:19:47,051 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:19:47,051 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:19:47,052 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:19:47,053 - INFO - START: processing column 'age'.
2026-01-14 20:19:47,054 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:19:47,055 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:19:47,056 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:19:47,057 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:19:47,057 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:19:47,057 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:19:47,096 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:19:47,102 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:19:47,103 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:19:47,103 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:19:47,117 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:19:47,119 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:19:47,119 - INFO - Running full analysis pipeline...
2026-01-14 20:19:47,119 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:19:47,124 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:19:47,124 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:19:47,128 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:19:47,129 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:19:47,134 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:19:47,136 - INFO - ==================================================
2026-01-14 20:19:47,136 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:19:47,137 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:19:47,137 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:19:47,137 - INFO - ==================================================
2026-01-14 20:19:47,148 - INFO - Generating visualizations...
2026-01-14 20:19:47,149 - INFO - Running full analysis pipeline...
2026-01-14 20:19:47,149 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:19:47,154 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:19:47,155 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:19:47,161 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:19:47,161 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:19:47,165 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:19:47,166 - INFO - ==================================================
2026-01-14 20:19:47,167 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:19:47,167 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:19:47,167 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:19:47,167 - INFO - ==================================================
2026-01-14 20:19:47,167 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:19:47,168 - INFO - Generating Stacked Bar Chart
2026-01-14 20:19:47,734 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:19:47,735 - INFO - Generating Mosaic Plot...
2026-01-14 20:19:48,136 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:19:48,137 - INFO - Generating Residuals Heatmap...
2026-01-14 20:19:48,480 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:19:48,480 - INFO - Generating Forest Plot...
2026-01-14 20:19:48,781 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:19:48,781 - INFO - Generating Lollipop Plot...
2026-01-14 20:19:49,029 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:19:49,030 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:19:49,030 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:19:49,030 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:19:49,030 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:19:49,044 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:19:49,045 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:19:49,045 - INFO - Preparing data for optimization analysis...
2026-01-14 20:19:49,059 - INFO - Calculating metrics for each K...
2026-01-14 20:19:55,267 - INFO - Generating Elbow plot...
2026-01-14 20:19:55,619 - INFO - Saved: Elbow Method
2026-01-14 20:19:55,620 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:19:55,620 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:19:55,672 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:19:55,673 - INFO - START: Generating PCA Visualization.
2026-01-14 20:19:56,212 - INFO - Saved: plot_clusters_pca
2026-01-14 20:19:56,213 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:19:56,214 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:19:56,218 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:19:56,218 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:19:56,232 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:19:56,234 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:19:56,540 - INFO - Saved: plot_risk_analysis
2026-01-14 20:19:56,540 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:19:56,839 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:19:56,839 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:19:56,840 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:20:31,637 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:20:31,638 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:20:31,647 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:20:31,647 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:20:31,648 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:20:31,649 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:20:31,650 - INFO - START: processing column 'bmi'.
2026-01-14 20:20:31,651 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:20:31,651 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:20:31,652 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:20:31,653 - INFO - START: processing column 'age'.
2026-01-14 20:20:31,655 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:20:31,655 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:20:31,657 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:20:31,657 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:20:31,658 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:20:31,658 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:20:31,698 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:20:31,706 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1492, 'both_high': 428, 'glucose_only': 393}
2026-01-14 20:20:31,706 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:20:31,706 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:20:31,717 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:20:31,719 - INFO - Test Finished. P-value: 0.00000 | Result: Significant (Reject H0)
2026-01-14 20:20:31,719 - INFO - Running full analysis pipeline...
2026-01-14 20:20:31,719 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:20:31,726 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:20:31,727 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:20:31,732 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:20:31,733 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:20:31,738 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:20:31,740 - INFO - ==================================================
2026-01-14 20:20:31,740 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:20:31,740 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:20:31,741 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:20:31,741 - INFO - ==================================================
2026-01-14 20:20:31,754 - INFO - Generating visualizations...
2026-01-14 20:20:31,755 - INFO - Running full analysis pipeline...
2026-01-14 20:20:31,756 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:20:31,762 - INFO - Analysis Done. RR=3.0255, p=0.0000
2026-01-14 20:20:31,762 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:20:31,767 - INFO - Analysis Done. RR=0.8332, p=0.2832
2026-01-14 20:20:31,767 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:20:31,772 - INFO - Analysis Done. RR=2.8336, p=0.0000
2026-01-14 20:20:31,774 - INFO - ==================================================
2026-01-14 20:20:31,775 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:20:31,775 - INFO - The group with the HIGHEST Relative Risk is: 'both_high vs neither'
2026-01-14 20:20:31,775 - INFO - Risk Factor (RR): 3.0255 (CI: 2.1981-4.1642)
2026-01-14 20:20:31,776 - INFO - ==================================================
2026-01-14 20:20:31,776 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:20:31,776 - INFO - Generating Stacked Bar Chart
2026-01-14 20:20:32,317 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:20:32,318 - INFO - Generating Mosaic Plot...
2026-01-14 20:20:32,735 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:20:32,735 - INFO - Generating Residuals Heatmap...
2026-01-14 20:20:33,077 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:20:33,078 - INFO - Generating Forest Plot...
2026-01-14 20:20:33,373 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:20:33,374 - INFO - Generating Lollipop Plot...
2026-01-14 20:20:33,631 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:20:33,631 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:20:33,631 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:20:33,631 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:20:33,631 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:20:33,633 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:20:33,634 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:20:33,634 - INFO - Preparing data for optimization analysis...
2026-01-14 20:20:33,644 - INFO - Calculating metrics for each K...
2026-01-14 20:20:39,757 - INFO - Generating Elbow plot...
2026-01-14 20:20:40,100 - INFO - Saved: Elbow Method
2026-01-14 20:20:40,100 - INFO - Optimization complete. Calculated Best K: 2
2026-01-14 20:20:40,101 - INFO - START: Starting K-Means pipeline with 2 clusters.
2026-01-14 20:20:40,154 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:20:40,154 - INFO - START: Generating PCA Visualization.
2026-01-14 20:20:40,689 - INFO - Saved: plot_clusters_pca
2026-01-14 20:20:40,690 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:20:40,691 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:20:40,695 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        40.82              88.69  28.29          0.07           0.04    0.04   4289
1        55.82             197.34  31.84          0.22           0.14    0.11    821
2026-01-14 20:20:40,696 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:20:40,708 - INFO - 
         gender work_type Residence_type smoking_status ever_married
cluster                                                             
0        Female   Private          Urban   never smoked          Yes
1        Female   Private          Urban   never smoked          Yes
2026-01-14 20:20:40,710 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:20:41,040 - INFO - Saved: plot_risk_analysis
2026-01-14 20:20:41,041 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:20:41,281 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:20:41,281 - INFO - SUCCESS: Clustering section complete with 2 clusters.
2026-01-14 20:20:41,281 - INFO - >>> Pipeline Finished Successfully. <<<
2026-01-14 20:22:38,820 - INFO - >>> Starting the Stroke Analysis Pipeline... <<<
2026-01-14 20:22:38,821 - INFO - Attempting to load dataset from stroke_df/healthcare-dataset-stroke-data.csv
2026-01-14 20:22:38,832 - INFO - Dataset loaded successfully. Shape: (5110, 12)
2026-01-14 20:22:38,832 - INFO - --- Phase 1: Data Cleaning ---
2026-01-14 20:22:38,833 - INFO - START: Attempting to remove columns: ['id']
2026-01-14 20:22:38,834 - INFO - Successfully dropped columns: ['id']
2026-01-14 20:22:38,835 - INFO - START: processing column 'bmi'.
2026-01-14 20:22:38,835 - INFO - SUCCESS: Column 'bmi' converted. 0 invalid values set to NaN.
2026-01-14 20:22:38,836 - INFO - START: processing column 'avg_glucose_level'.
2026-01-14 20:22:38,837 - INFO - SUCCESS: Column 'avg_glucose_level' converted. 0 invalid values set to NaN.
2026-01-14 20:22:38,837 - INFO - START: processing column 'age'.
2026-01-14 20:22:38,839 - INFO - SUCCESS: Column 'age' converted. 0 invalid values set to NaN.
2026-01-14 20:22:38,839 - INFO - START: Filling missing values for 'bmi' using Median.
2026-01-14 20:22:38,840 - INFO - Action: Filled 201 missing values with median (28.10).
2026-01-14 20:22:38,841 - INFO - SUCCESS: Column 'bmi' processing complete.
2026-01-14 20:22:38,841 - INFO - --- Phase 2: Outlier Detection ---
2026-01-14 20:22:38,841 - INFO - Starting outlier removal for 'bmi' (Threshold: 2.0)
2026-01-14 20:22:38,843 - INFO - IQR Bounds calculated for 'bmi': [5.80, 50.80]
2026-01-14 20:22:38,844 - INFO - Stats: Removing 67 outliers (1.31% of data).
2026-01-14 20:22:38,845 - INFO - Starting outlier removal for 'avg_glucose_level' (Threshold: 1.5)
2026-01-14 20:22:38,847 - INFO - IQR Bounds calculated for 'avg_glucose_level': [22.24, 168.98]
2026-01-14 20:22:38,848 - INFO - Stats: Removing 608 outliers (12.06% of data).
2026-01-14 20:22:38,848 - WARNING - High outlier count! Removing >10% of data from 'avg_glucose_level'. Check threshold.
2026-01-14 20:22:38,849 - INFO - --- Phase 3: Feature Engineering ---
2026-01-14 20:22:38,849 - INFO - Starting conversion of continuous variables to binary flags...
2026-01-14 20:22:38,882 - INFO - Successfully created 'risk_group' column.
2026-01-14 20:22:38,887 - INFO - Composite Variable Created. Group Distribution: {'neither': 2797, 'bmi_only': 1444, 'glucose_only': 123, 'both_high': 71}
2026-01-14 20:22:38,887 - INFO - --- Phase 4: Statistical Analysis ---
2026-01-14 20:22:38,888 - INFO - --- Starting Chi-Square Test: risk_group vs stroke ---
2026-01-14 20:22:38,897 - INFO - Contingency table created successfully. Shape: (4, 2)
2026-01-14 20:22:38,899 - WARNING - Assumption Warning: Some expected frequencies are < 5. Results may be less accurate.
2026-01-14 20:22:38,899 - INFO - Test Finished. P-value: 0.72941 | Result: Not Significant (Fail to Reject H0)
2026-01-14 20:22:38,899 - INFO - Running full analysis pipeline...
2026-01-14 20:22:38,900 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:22:38,904 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 20:22:38,904 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:22:38,912 - INFO - Analysis Done. RR=0.8609, p=0.3785
2026-01-14 20:22:38,912 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:22:38,917 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 20:22:38,919 - INFO - ==================================================
2026-01-14 20:22:38,919 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:22:38,920 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 20:22:38,920 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 20:22:38,921 - INFO - ==================================================
2026-01-14 20:22:38,930 - INFO - Generating visualizations...
2026-01-14 20:22:38,930 - INFO - Running full analysis pipeline...
2026-01-14 20:22:38,930 - INFO - Starting analysis: Comparing 'both_high' vs 'neither'
2026-01-14 20:22:38,935 - INFO - Analysis Done. RR=1.0943, p=0.8752
2026-01-14 20:22:38,935 - INFO - Starting analysis: Comparing 'bmi_only' vs 'neither'
2026-01-14 20:22:38,941 - INFO - Analysis Done. RR=0.8609, p=0.3785
2026-01-14 20:22:38,941 - INFO - Starting analysis: Comparing 'glucose_only' vs 'neither'
2026-01-14 20:22:38,946 - INFO - Analysis Done. RR=1.2633, p=0.5688
2026-01-14 20:22:38,948 - INFO - ==================================================
2026-01-14 20:22:38,948 - INFO - SUMMARY - FINAL CONCLUSION:
2026-01-14 20:22:38,949 - INFO - The group with the HIGHEST Relative Risk is: 'glucose_only vs neither'
2026-01-14 20:22:38,949 - INFO - Risk Factor (RR): 1.2633 (CI: 0.5665-2.8173)
2026-01-14 20:22:38,949 - INFO - ==================================================
2026-01-14 20:22:38,950 - INFO - --- Starting Visualization Pipeline ---
2026-01-14 20:22:38,950 - INFO - Generating Stacked Bar Chart
2026-01-14 20:22:39,453 - INFO - Saved: 1_stacked_bar.png
2026-01-14 20:22:39,453 - INFO - Generating Mosaic Plot...
2026-01-14 20:22:39,805 - INFO - Saved: 2_mosaic_plot.png
2026-01-14 20:22:39,805 - INFO - Generating Residuals Heatmap...
2026-01-14 20:22:40,131 - INFO - Saved: 3_residuals_heatmap.png
2026-01-14 20:22:40,132 - INFO - Generating Forest Plot...
2026-01-14 20:22:40,419 - INFO - Saved: 4_forest_plot.png
2026-01-14 20:22:40,420 - INFO - Generating Lollipop Plot...
2026-01-14 20:22:40,721 - INFO - Saved: 5_lollipop_plot.png
2026-01-14 20:22:40,722 - INFO - --- Visualization Pipeline Completed ---
2026-01-14 20:22:40,722 - INFO - All visualizations have been successfully saved to the project folder.
2026-01-14 20:22:40,722 - INFO - --- Phase 5: Cluster Analysis ---
2026-01-14 20:22:40,722 - INFO - START: Attempting to remove columns: ['stroke']
2026-01-14 20:22:40,724 - INFO - Successfully dropped columns: ['stroke']
2026-01-14 20:22:40,724 - INFO - START: Searching for optimal K (range: 0 to 10).
2026-01-14 20:22:40,724 - INFO - Preparing data for optimization analysis...
2026-01-14 20:22:40,735 - INFO - Calculating metrics for each K...
2026-01-14 20:22:46,245 - INFO - Generating Elbow plot...
2026-01-14 20:22:46,653 - INFO - Saved: Elbow Method
2026-01-14 20:22:46,653 - INFO - Optimization complete. Calculated Best K: 7
2026-01-14 20:22:46,653 - INFO - START: Starting K-Means pipeline with 7 clusters.
2026-01-14 20:22:46,740 - INFO - SUCCESS: Clustering pipeline complete.
2026-01-14 20:22:46,741 - INFO - START: Generating PCA Visualization.
2026-01-14 20:22:47,447 - INFO - Saved: plot_clusters_pca
2026-01-14 20:22:47,449 - INFO - START: Generating Cluster Profile Report...
2026-01-14 20:22:47,449 - INFO - Calculating numeric averages (Profile):
2026-01-14 20:22:47,463 - INFO - 
           age  avg_glucose_level    bmi  hypertension  heart_disease  stroke  Count
cluster                                                                             
0        61.00              88.35  31.28          1.00           0.10    0.12    312
1        42.03              88.89  25.22          0.00           0.03    0.04   1679
2         6.80              90.11  20.08          0.00           0.00    0.00    646
3        44.90              88.27  35.55          0.00           0.03    0.02   1058
4        38.74             152.33  24.42          0.06           0.03    0.05    123
5        57.78              87.73  29.08          0.00           0.08    0.06    546
6        48.92             151.67  35.84          0.13           0.07    0.04     71
2026-01-14 20:22:47,464 - INFO - Calculating dominant categorical features (Mode):
2026-01-14 20:22:47,480 - INFO - 
         gender      work_type Residence_type smoking_status ever_married
cluster                                                                  
0        Female        Private          Rural   never smoked          Yes
1        Female        Private          Urban   never smoked          Yes
2          Male       children          Urban        Unknown           No
3        Female        Private          Urban   never smoked          Yes
4        Female        Private          Rural        Unknown          Yes
5        Female  Self-employed          Urban   never smoked          Yes
6        Female        Private          Urban   never smoked          Yes
2026-01-14 20:22:47,483 - INFO - START: Generating Risk Bar Chart.
2026-01-14 20:22:47,865 - INFO - Saved: plot_risk_analysis
2026-01-14 20:22:47,866 - INFO - START: Generating Capture Rate Pie Chart.
2026-01-14 20:22:48,139 - INFO - Saved: plot_stroke_capture_rate
2026-01-14 20:22:48,140 - INFO - SUCCESS: Clustering section complete with 7 clusters.
2026-01-14 20:22:48,140 - INFO - >>> Pipeline Finished Successfully. <<<
